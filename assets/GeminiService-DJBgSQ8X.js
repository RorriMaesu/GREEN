/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class z{}function E(i,t){const e=/\{([^}]+)\}/g;return i.replace(e,(n,r)=>{if(Object.prototype.hasOwnProperty.call(t,r)){const l=t[r];return l!=null?String(l):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function o(i,t,e){for(let l=0;l<t.length-1;l++){const a=t[l];if(a.endsWith("[]")){const u=a.slice(0,-2);if(!(u in i))if(Array.isArray(e))i[u]=Array.from({length:e.length},()=>({}));else throw new Error(`Value must be a list given an array path ${a}`);if(Array.isArray(i[u])){const c=i[u];if(Array.isArray(e))for(let d=0;d<c.length;d++){const f=c[d];o(f,t.slice(l+1),e[d])}else for(const d of c)o(d,t.slice(l+1),e)}return}else if(a.endsWith("[0]")){const u=a.slice(0,-3);u in i||(i[u]=[{}]);const c=i[u];o(c[0],t.slice(l+1),e);return}(!i[a]||typeof i[a]!="object")&&(i[a]={}),i=i[a]}const n=t[t.length-1],r=i[n];if(r!==void 0){if(!e||typeof e=="object"&&Object.keys(e).length===0||e===r)return;if(typeof r=="object"&&typeof e=="object"&&r!==null&&e!==null)Object.assign(r,e);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else i[n]=e}function s(i,t){try{if(t.length===1&&t[0]==="_self")return i;for(let e=0;e<t.length;e++){if(typeof i!="object"||i===null)return;const n=t[e];if(n.endsWith("[]")){const r=n.slice(0,-2);if(r in i){const l=i[r];return Array.isArray(l)?l.map(a=>s(a,t.slice(e+1))):void 0}else return}else i=i[n]}return i}catch(e){if(e instanceof TypeError)return;throw e}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function w(i,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(i.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const e=t.split("/",2);return`publishers/${e[0]}/models/${e[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function st(i,t){const e=w(i,t);return e?e.startsWith("publishers/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/${e}`:e.startsWith("models/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/publishers/google/${e}`:e:""}function ie(i,t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function rt(i,t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>ie(i,e)):[ie(i,t)]}function Z(i){return i!=null&&typeof i=="object"&&"parts"in i&&Array.isArray(i.parts)}function se(i){return i!=null&&typeof i=="object"&&"functionCall"in i}function re(i){return i!=null&&typeof i=="object"&&"functionResponse"in i}function D(i,t){if(t==null)throw new Error("ContentUnion is required");return Z(t)?t:{role:"user",parts:rt(i,t)}}function lt(i,t){if(!t)return[];if(i.isVertexAI()&&Array.isArray(t))return t.flatMap(e=>{const n=D(i,e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(i.isVertexAI()){const e=D(i,t);return e.parts&&e.parts.length>0&&e.parts[0].text!==void 0?[e.parts[0].text]:[]}return Array.isArray(t)?t.map(e=>D(i,e)):[D(i,t)]}function S(i,t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(se(t)||re(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[D(i,t)]}const e=[],n=[],r=Z(t[0]);for(const l of t){const a=Z(l);if(a!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(l);else{if(se(l)||re(l))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(l)}}return r||e.push({role:"user",parts:rt(i,n)}),e}function B(i,t){if(!i.isVertexAI()&&"default"in t)throw new Error("Default value is not supported in the response schema for the Gemini API.");if("anyOf"in t&&t.anyOf!==void 0)for(const e of t.anyOf)B(i,e);if("items"in t&&t.items!==void 0&&B(i,t.items),"properties"in t&&t.properties!==void 0)for(const e of Object.values(t.properties))B(i,e)}function at(i,t){return B(i,t),t}function ut(i,t){if(typeof t=="object"&&"voiceConfig"in t)return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function X(i,t){return t}function N(i,t){if(!Array.isArray(t))throw new Error("tool is required and must be an array of Tools");return t}function yt(i,t,e,n=1){const r=!t.startsWith(`${e}/`)&&t.split("/").length===n;return i.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${i.getProject()}/${t}`:t.startsWith(`${e}/`)?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}`:r?`projects/${i.getProject()}/locations/${i.getLocation()}/${e}/${t}`:t:r?`${e}/${t}`:t}function F(i,t){if(typeof t!="string")throw new Error("name must be a string");return yt(i,t,"cachedContents")}function k(i,t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}function ct(i,t){if(typeof t!="string")throw new Error("fromName must be a string");return t.startsWith("files/")?t.split("files/")[1]:t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ct(i,t){const e={};if(s(t,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const n=s(t,["thought"]);n!=null&&o(e,["thought"],n);const r=s(t,["codeExecutionResult"]);r!=null&&o(e,["codeExecutionResult"],r);const l=s(t,["executableCode"]);l!=null&&o(e,["executableCode"],l);const a=s(t,["fileData"]);a!=null&&o(e,["fileData"],a);const u=s(t,["functionCall"]);u!=null&&o(e,["functionCall"],u);const c=s(t,["functionResponse"]);c!=null&&o(e,["functionResponse"],c);const d=s(t,["inlineData"]);d!=null&&o(e,["inlineData"],d);const f=s(t,["text"]);return f!=null&&o(e,["text"],f),e}function le(i,t){const e={},n=s(t,["parts"]);n!=null&&(Array.isArray(n)?o(e,["parts"],n.map(l=>Ct(i,l))):o(e,["parts"],n));const r=s(t,["role"]);return r!=null&&o(e,["role"],r),e}function Tt(i,t){const e={};if(s(t,["response"])!==void 0)throw new Error("response parameter is not supported in Gemini API.");const n=s(t,["description"]);n!=null&&o(e,["description"],n);const r=s(t,["name"]);r!=null&&o(e,["name"],r);const l=s(t,["parameters"]);return l!=null&&o(e,["parameters"],l),e}function vt(){return{}}function It(i,t){const e={},n=s(t,["mode"]);n!=null&&o(e,["mode"],n);const r=s(t,["dynamicThreshold"]);return r!=null&&o(e,["dynamicThreshold"],r),e}function Et(i,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&o(e,["dynamicRetrievalConfig"],It(i,n)),e}function _t(i,t){const e={},n=s(t,["functionDeclarations"]);if(n!=null&&(Array.isArray(n)?o(e,["functionDeclarations"],n.map(u=>Tt(i,u))):o(e,["functionDeclarations"],n)),s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");s(t,["googleSearch"])!=null&&o(e,["googleSearch"],vt());const l=s(t,["googleSearchRetrieval"]);l!=null&&o(e,["googleSearchRetrieval"],Et(i,l));const a=s(t,["codeExecution"]);return a!=null&&o(e,["codeExecution"],a),e}function St(i,t){const e={},n=s(t,["mode"]);n!=null&&o(e,["mode"],n);const r=s(t,["allowedFunctionNames"]);return r!=null&&o(e,["allowedFunctionNames"],r),e}function At(i,t){const e={},n=s(t,["functionCallingConfig"]);return n!=null&&o(e,["functionCallingConfig"],St(i,n)),e}function wt(i,t,e){const n={},r=s(t,["ttl"]);e!==void 0&&r!=null&&o(e,["ttl"],r);const l=s(t,["expireTime"]);e!==void 0&&l!=null&&o(e,["expireTime"],l);const a=s(t,["displayName"]);e!==void 0&&a!=null&&o(e,["displayName"],a);const u=s(t,["contents"]);e!==void 0&&u!=null&&(Array.isArray(u)?o(e,["contents"],S(i,S(i,u).map(m=>le(i,m)))):o(e,["contents"],S(i,u)));const c=s(t,["systemInstruction"]);e!==void 0&&c!=null&&o(e,["systemInstruction"],le(i,D(i,c)));const d=s(t,["tools"]);e!==void 0&&d!=null&&(Array.isArray(d)?o(e,["tools"],d.map(m=>_t(i,m))):o(e,["tools"],d));const f=s(t,["toolConfig"]);return e!==void 0&&f!=null&&o(e,["toolConfig"],At(i,f)),n}function Mt(i,t){const e={},n=s(t,["model"]);n!=null&&o(e,["model"],st(i,n));const r=s(t,["config"]);return r!=null&&o(e,["config"],wt(i,r,e)),e}function Pt(i,t){const e={},n=s(t,["name"]);n!=null&&o(e,["_url","name"],F(i,n));const r=s(t,["config"]);return r!=null&&o(e,["config"],r),e}function Rt(i,t){const e={},n=s(t,["name"]);n!=null&&o(e,["_url","name"],F(i,n));const r=s(t,["config"]);return r!=null&&o(e,["config"],r),e}function xt(i,t,e){const n={},r=s(t,["ttl"]);e!==void 0&&r!=null&&o(e,["ttl"],r);const l=s(t,["expireTime"]);return e!==void 0&&l!=null&&o(e,["expireTime"],l),n}function Dt(i,t){const e={},n=s(t,["name"]);n!=null&&o(e,["_url","name"],F(i,n));const r=s(t,["config"]);return r!=null&&o(e,["config"],xt(i,r,e)),e}function Nt(i,t,e){const n={},r=s(t,["pageSize"]);e!==void 0&&r!=null&&o(e,["_query","pageSize"],r);const l=s(t,["pageToken"]);return e!==void 0&&l!=null&&o(e,["_query","pageToken"],l),n}function Ft(i,t){const e={},n=s(t,["config"]);return n!=null&&o(e,["config"],Nt(i,n,e)),e}function kt(i,t){const e={},n=s(t,["videoMetadata"]);n!=null&&o(e,["videoMetadata"],n);const r=s(t,["thought"]);r!=null&&o(e,["thought"],r);const l=s(t,["codeExecutionResult"]);l!=null&&o(e,["codeExecutionResult"],l);const a=s(t,["executableCode"]);a!=null&&o(e,["executableCode"],a);const u=s(t,["fileData"]);u!=null&&o(e,["fileData"],u);const c=s(t,["functionCall"]);c!=null&&o(e,["functionCall"],c);const d=s(t,["functionResponse"]);d!=null&&o(e,["functionResponse"],d);const f=s(t,["inlineData"]);f!=null&&o(e,["inlineData"],f);const m=s(t,["text"]);return m!=null&&o(e,["text"],m),e}function ae(i,t){const e={},n=s(t,["parts"]);n!=null&&(Array.isArray(n)?o(e,["parts"],n.map(l=>kt(i,l))):o(e,["parts"],n));const r=s(t,["role"]);return r!=null&&o(e,["role"],r),e}function Vt(i,t){const e={},n=s(t,["example"]);n!=null&&o(e,["example"],n);const r=s(t,["pattern"]);r!=null&&o(e,["pattern"],r);const l=s(t,["default"]);l!=null&&o(e,["default"],l);const a=s(t,["maxLength"]);a!=null&&o(e,["maxLength"],a);const u=s(t,["minLength"]);u!=null&&o(e,["minLength"],u);const c=s(t,["minProperties"]);c!=null&&o(e,["minProperties"],c);const d=s(t,["maxProperties"]);d!=null&&o(e,["maxProperties"],d);const f=s(t,["anyOf"]);f!=null&&o(e,["anyOf"],f);const m=s(t,["description"]);m!=null&&o(e,["description"],m);const p=s(t,["enum"]);p!=null&&o(e,["enum"],p);const g=s(t,["format"]);g!=null&&o(e,["format"],g);const h=s(t,["items"]);h!=null&&o(e,["items"],h);const C=s(t,["maxItems"]);C!=null&&o(e,["maxItems"],C);const y=s(t,["maximum"]);y!=null&&o(e,["maximum"],y);const T=s(t,["minItems"]);T!=null&&o(e,["minItems"],T);const v=s(t,["minimum"]);v!=null&&o(e,["minimum"],v);const I=s(t,["nullable"]);I!=null&&o(e,["nullable"],I);const _=s(t,["properties"]);_!=null&&o(e,["properties"],_);const A=s(t,["propertyOrdering"]);A!=null&&o(e,["propertyOrdering"],A);const P=s(t,["required"]);P!=null&&o(e,["required"],P);const R=s(t,["title"]);R!=null&&o(e,["title"],R);const x=s(t,["type"]);return x!=null&&o(e,["type"],x),e}function Ut(i,t){const e={},n=s(t,["response"]);n!=null&&o(e,["response"],Vt(i,n));const r=s(t,["description"]);r!=null&&o(e,["description"],r);const l=s(t,["name"]);l!=null&&o(e,["name"],l);const a=s(t,["parameters"]);return a!=null&&o(e,["parameters"],a),e}function Lt(){return{}}function Gt(i,t){const e={},n=s(t,["mode"]);n!=null&&o(e,["mode"],n);const r=s(t,["dynamicThreshold"]);return r!=null&&o(e,["dynamicThreshold"],r),e}function qt(i,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&o(e,["dynamicRetrievalConfig"],Gt(i,n)),e}function $t(i,t){const e={},n=s(t,["functionDeclarations"]);n!=null&&(Array.isArray(n)?o(e,["functionDeclarations"],n.map(c=>Ut(i,c))):o(e,["functionDeclarations"],n));const r=s(t,["retrieval"]);r!=null&&o(e,["retrieval"],r),s(t,["googleSearch"])!=null&&o(e,["googleSearch"],Lt());const a=s(t,["googleSearchRetrieval"]);a!=null&&o(e,["googleSearchRetrieval"],qt(i,a));const u=s(t,["codeExecution"]);return u!=null&&o(e,["codeExecution"],u),e}function Bt(i,t){const e={},n=s(t,["mode"]);n!=null&&o(e,["mode"],n);const r=s(t,["allowedFunctionNames"]);return r!=null&&o(e,["allowedFunctionNames"],r),e}function Ht(i,t){const e={},n=s(t,["functionCallingConfig"]);return n!=null&&o(e,["functionCallingConfig"],Bt(i,n)),e}function Wt(i,t,e){const n={},r=s(t,["ttl"]);e!==void 0&&r!=null&&o(e,["ttl"],r);const l=s(t,["expireTime"]);e!==void 0&&l!=null&&o(e,["expireTime"],l);const a=s(t,["displayName"]);e!==void 0&&a!=null&&o(e,["displayName"],a);const u=s(t,["contents"]);e!==void 0&&u!=null&&(Array.isArray(u)?o(e,["contents"],S(i,S(i,u).map(m=>ae(i,m)))):o(e,["contents"],S(i,u)));const c=s(t,["systemInstruction"]);e!==void 0&&c!=null&&o(e,["systemInstruction"],ae(i,D(i,c)));const d=s(t,["tools"]);e!==void 0&&d!=null&&(Array.isArray(d)?o(e,["tools"],d.map(m=>$t(i,m))):o(e,["tools"],d));const f=s(t,["toolConfig"]);return e!==void 0&&f!=null&&o(e,["toolConfig"],Ht(i,f)),n}function Yt(i,t){const e={},n=s(t,["model"]);n!=null&&o(e,["model"],st(i,n));const r=s(t,["config"]);return r!=null&&o(e,["config"],Wt(i,r,e)),e}function Kt(i,t){const e={},n=s(t,["name"]);n!=null&&o(e,["_url","name"],F(i,n));const r=s(t,["config"]);return r!=null&&o(e,["config"],r),e}function Jt(i,t){const e={},n=s(t,["name"]);n!=null&&o(e,["_url","name"],F(i,n));const r=s(t,["config"]);return r!=null&&o(e,["config"],r),e}function zt(i,t,e){const n={},r=s(t,["ttl"]);e!==void 0&&r!=null&&o(e,["ttl"],r);const l=s(t,["expireTime"]);return e!==void 0&&l!=null&&o(e,["expireTime"],l),n}function Xt(i,t){const e={},n=s(t,["name"]);n!=null&&o(e,["_url","name"],F(i,n));const r=s(t,["config"]);return r!=null&&o(e,["config"],zt(i,r,e)),e}function Qt(i,t,e){const n={},r=s(t,["pageSize"]);e!==void 0&&r!=null&&o(e,["_query","pageSize"],r);const l=s(t,["pageToken"]);return e!==void 0&&l!=null&&o(e,["_query","pageToken"],l),n}function Ot(i,t){const e={},n=s(t,["config"]);return n!=null&&o(e,["config"],Qt(i,n,e)),e}function H(i,t){const e={},n=s(t,["name"]);n!=null&&o(e,["name"],n);const r=s(t,["displayName"]);r!=null&&o(e,["displayName"],r);const l=s(t,["model"]);l!=null&&o(e,["model"],l);const a=s(t,["createTime"]);a!=null&&o(e,["createTime"],a);const u=s(t,["updateTime"]);u!=null&&o(e,["updateTime"],u);const c=s(t,["expireTime"]);c!=null&&o(e,["expireTime"],c);const d=s(t,["usageMetadata"]);return d!=null&&o(e,["usageMetadata"],d),e}function Zt(){return{}}function bt(i,t){const e={},n=s(t,["nextPageToken"]);n!=null&&o(e,["nextPageToken"],n);const r=s(t,["cachedContents"]);return r!=null&&(Array.isArray(r)?o(e,["cachedContents"],r.map(l=>H(i,l))):o(e,["cachedContents"],r)),e}function W(i,t){const e={},n=s(t,["name"]);n!=null&&o(e,["name"],n);const r=s(t,["displayName"]);r!=null&&o(e,["displayName"],r);const l=s(t,["model"]);l!=null&&o(e,["model"],l);const a=s(t,["createTime"]);a!=null&&o(e,["createTime"],a);const u=s(t,["updateTime"]);u!=null&&o(e,["updateTime"],u);const c=s(t,["expireTime"]);c!=null&&o(e,["expireTime"],c);const d=s(t,["usageMetadata"]);return d!=null&&o(e,["usageMetadata"],d),e}function jt(){return{}}function en(i,t){const e={},n=s(t,["nextPageToken"]);n!=null&&o(e,["nextPageToken"],n);const r=s(t,["cachedContents"]);return r!=null&&(Array.isArray(r)?o(e,["cachedContents"],r.map(l=>W(i,l))):o(e,["cachedContents"],r)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Y;(function(i){i.PAGED_ITEM_BATCH_JOBS="batchJobs",i.PAGED_ITEM_MODELS="models",i.PAGED_ITEM_TUNING_JOBS="tuningJobs",i.PAGED_ITEM_FILES="files",i.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Y||(Y={}));class dt{constructor(t,e,n,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=e,this.init(t,n,r)}init(t,e,n){var r,l;this.nameInternal=t,this.pageInternal=e[this.nameInternal]||[],this.idxInternal=0;let a={config:{}};n?typeof n=="object"?a=Object.assign({},n):a=n:a={config:{}},a.config&&(a.config.pageToken=e.nextPageToken),this.paramsInternal=a,this.pageInternalSize=(l=(r=a.config)===null||r===void 0?void 0:r.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ue;(function(i){i.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",i.OUTCOME_OK="OUTCOME_OK",i.OUTCOME_FAILED="OUTCOME_FAILED",i.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(ue||(ue={}));var ce;(function(i){i.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",i.PYTHON="PYTHON"})(ce||(ce={}));var de;(function(i){i.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",i.STRING="STRING",i.NUMBER="NUMBER",i.INTEGER="INTEGER",i.BOOLEAN="BOOLEAN",i.ARRAY="ARRAY",i.OBJECT="OBJECT"})(de||(de={}));var fe;(function(i){i.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",i.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",i.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",i.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",i.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(fe||(fe={}));var pe;(function(i){i.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",i.SEVERITY="SEVERITY",i.PROBABILITY="PROBABILITY"})(pe||(pe={}));var me;(function(i){i.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE",i.OFF="OFF"})(me||(me={}));var he;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(he||(he={}));var ge;(function(i){i.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",i.STOP="STOP",i.MAX_TOKENS="MAX_TOKENS",i.SAFETY="SAFETY",i.RECITATION="RECITATION",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.SPII="SPII",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.IMAGE_SAFETY="IMAGE_SAFETY"})(ge||(ge={}));var ye;(function(i){i.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",i.NEGLIGIBLE="NEGLIGIBLE",i.LOW="LOW",i.MEDIUM="MEDIUM",i.HIGH="HIGH"})(ye||(ye={}));var Ce;(function(i){i.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",i.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",i.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",i.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",i.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Ce||(Ce={}));var Te;(function(i){i.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",i.SAFETY="SAFETY",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(Te||(Te={}));var ve;(function(i){i.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",i.ON_DEMAND="ON_DEMAND",i.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(ve||(ve={}));var K;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.AUDIO="AUDIO"})(K||(K={}));var Ie;(function(i){i.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",i.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",i.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",i.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Ie||(Ie={}));var Ee;(function(i){i.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",i.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",i.BALANCED="BALANCED",i.PRIORITIZE_COST="PRIORITIZE_COST"})(Ee||(Ee={}));var _e;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(_e||(_e={}));var Se;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.AUTO="AUTO",i.ANY="ANY",i.NONE="NONE"})(Se||(Se={}));var Ae;(function(i){i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE"})(Ae||(Ae={}));var we;(function(i){i.DONT_ALLOW="DONT_ALLOW",i.ALLOW_ADULT="ALLOW_ADULT",i.ALLOW_ALL="ALLOW_ALL"})(we||(we={}));var Me;(function(i){i.auto="auto",i.en="en",i.ja="ja",i.ko="ko",i.hi="hi"})(Me||(Me={}));var Pe;(function(i){i.STATE_UNSPECIFIED="STATE_UNSPECIFIED",i.PROCESSING="PROCESSING",i.ACTIVE="ACTIVE",i.FAILED="FAILED"})(Pe||(Pe={}));var Re;(function(i){i.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",i.UPLOADED="UPLOADED",i.GENERATED="GENERATED"})(Re||(Re={}));var xe;(function(i){i.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",i.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",i.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",i.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",i.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(xe||(xe={}));var De;(function(i){i.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",i.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",i.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",i.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(De||(De={}));var Ne;(function(i){i.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",i.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",i.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",i.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Ne||(Ne={}));var Fe;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.VIDEO="VIDEO",i.AUDIO="AUDIO",i.DOCUMENT="DOCUMENT"})(Fe||(Fe={}));var ke;(function(i){i.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",i.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",i.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(ke||(ke={}));var Ve;(function(i){i.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",i.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",i.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Ve||(Ve={}));var Ue;(function(i){i.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",i.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",i.NO_INTERRUPTION="NO_INTERRUPTION"})(Ue||(Ue={}));var Le;(function(i){i.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",i.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",i.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Le||(Le={}));function Ge(i){return{text:i}}function qe(i){return typeof i=="object"&&i!==null?"fileData"in i||"text"in i||"functionCall"in i||"functionResponse"in i||"inlineData"in i||"videoMetadata"in i||"codeExecutionResult"in i||"executableCode"in i:!1}function tn(i){const t=[];if(typeof i=="string")t.push(Ge(i));else if(qe(i))t.push(i);else if(Array.isArray(i)){if(i.length===0)throw new Error("partOrString cannot be an empty array");for(const e of i)if(typeof e=="string")t.push(Ge(e));else if(qe(e))t.push(e);else throw new Error("element in PartUnion must be a Part object or string")}else throw new Error("partOrString must be a Part object, string, or array");return t}function $e(i){return{role:"user",parts:tn(i)}}class G{get text(){var t,e,n,r,l,a,u,c;if(((r=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",f=!1;const m=[];for(const p of(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(const[g,h]of Object.entries(p))g!=="text"&&g!=="thought"&&(h!==null||h!==void 0)&&m.push(g);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;f=!0,d+=p.text}}return m.length>0&&console.warn(`there are non-text parts ${m} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?d:void 0}get functionCalls(){var t,e,n,r,l,a,u,c;if(((r=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var t,e,n,r,l,a,u,c,d;if(((r=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(m=>m.executableCode).map(m=>m.executableCode).filter(m=>m!==void 0);if((f==null?void 0:f.length)!==0)return(d=f==null?void 0:f[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var t,e,n,r,l,a,u,c,d;if(((r=(n=(e=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||e===void 0?void 0:e.content)===null||n===void 0?void 0:n.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(c=(u=(a=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(m=>m.codeExecutionResult).map(m=>m.codeExecutionResult).filter(m=>m!==void 0);if((f==null?void 0:f.length)!==0)return(d=f==null?void 0:f[0])===null||d===void 0?void 0:d.output}}class Be{}class He{}class We{}class nn{}class Ye{}class Ke{}class on{}class b{constructor(t){const e={};for(const n of t.headers.entries())e[n[0]]=n[1];this.headers=e,this.responseInternal=t}json(){return this.responseInternal.json()}}class sn{}class rn{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ln extends z{constructor(t){super(),this.apiClient=t,this.list=async(e={})=>new dt(Y.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(e),e)}async create(t){var e,n;let r,l="",a={};if(this.apiClient.isVertexAI()){const u=Yt(this.apiClient,t);return l=E("cachedContents",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),r.then(c=>W(this.apiClient,c))}else{const u=Mt(this.apiClient,t);return l=E("cachedContents",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),r.then(c=>H(this.apiClient,c))}}async get(t){var e,n;let r,l="",a={};if(this.apiClient.isVertexAI()){const u=Kt(this.apiClient,t);return l=E("{name}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),r.then(c=>W(this.apiClient,c))}else{const u=Pt(this.apiClient,t);return l=E("{name}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),r.then(c=>H(this.apiClient,c))}}async delete(t){var e,n;let r,l="",a={};if(this.apiClient.isVertexAI()){const u=Jt(this.apiClient,t);return l=E("{name}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),r.then(()=>{const c=jt(),d=new Ye;return Object.assign(d,c),d})}else{const u=Rt(this.apiClient,t);return l=E("{name}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),r.then(()=>{const c=Zt(),d=new Ye;return Object.assign(d,c),d})}}async update(t){var e,n;let r,l="",a={};if(this.apiClient.isVertexAI()){const u=Xt(this.apiClient,t);return l=E("{name}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),r.then(c=>W(this.apiClient,c))}else{const u=Dt(this.apiClient,t);return l=E("{name}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),r.then(c=>H(this.apiClient,c))}}async listInternal(t){var e,n;let r,l="",a={};if(this.apiClient.isVertexAI()){const u=Ot(this.apiClient,t);return l=E("cachedContents",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),r.then(c=>{const d=en(this.apiClient,c),f=new Ke;return Object.assign(f,d),f})}else{const u=Ft(this.apiClient,t);return l=E("cachedContents",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),r.then(c=>{const d=bt(this.apiClient,c),f=new Ke;return Object.assign(f,d),f})}}}function Je(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],n=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function M(i){return this instanceof M?(this.v=i,this):new M(i)}function J(i,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e.apply(i,t||[]),r,l=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",a),r[Symbol.asyncIterator]=function(){return this},r;function a(g){return function(h){return Promise.resolve(h).then(g,m)}}function u(g,h){n[g]&&(r[g]=function(C){return new Promise(function(y,T){l.push([g,C,y,T])>1||c(g,C)})},h&&(r[g]=h(r[g])))}function c(g,h){try{d(n[g](h))}catch(C){p(l[0][3],C)}}function d(g){g.value instanceof M?Promise.resolve(g.value.v).then(f,m):p(l[0][2],g)}function f(g){c("next",g)}function m(g){c("throw",g)}function p(g,h){g(h),l.shift(),l.length&&c(l[0][0],l[0][1])}}function j(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=i[Symbol.asyncIterator],e;return t?t.call(i):(i=typeof Je=="function"?Je(i):i[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(l){e[l]=i[l]&&function(a){return new Promise(function(u,c){a=i[l](a),r(u,c,a.done,a.value)})}}function r(l,a,u,c){Promise.resolve(c).then(function(d){l({value:d,done:u})},a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function an(i){var t;if(i.candidates==null||i.candidates.length===0)return!1;const e=(t=i.candidates[0])===null||t===void 0?void 0:t.content;return e===void 0?!1:ft(e)}function ft(i){if(i.parts===void 0||i.parts.length===0)return!1;for(const t of i.parts)if(t===void 0||Object.keys(t).length===0||t.text!==void 0&&t.text==="")return!1;return!0}function un(i){if(i.length!==0){if(i[0].role!=="user")throw new Error("History must start with a user turn.");for(const t of i)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function cn(i){if(i===void 0||i.length===0)return[];const t=[],e=i.length;let n=0,r=i[0];for(;n<e;)if(i[n].role==="user")r=i[n],n++;else{const l=[];let a=!0;for(;n<e&&i[n].role==="model";)l.push(i[n]),a&&!ft(i[n])&&(a=!1),n++;a&&(t.push(r),t.push(...l))}return t}class dn{constructor(t,e){this.modelsModule=t,this.apiClient=e}create(t){return new fn(this.apiClient,this.modelsModule,t.model,t.config,t.history)}}class fn{constructor(t,e,n,r={},l=[]){this.apiClient=t,this.modelsModule=e,this.model=n,this.config=r,this.history=l,this.sendPromise=Promise.resolve(),un(l)}async sendMessage(t){var e;await this.sendPromise;const n=D(this.apiClient,t.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(e=t.config)!==null&&e!==void 0?e:this.config});return this.sendPromise=(async()=>{var l,a;const c=(a=(l=(await r).candidates)===null||l===void 0?void 0:l[0])===null||a===void 0?void 0:a.content,d=c?[c]:[];this.recordHistory(n,d)})(),await this.sendPromise,r}async sendMessageStream(t){var e;await this.sendPromise;const n=D(this.apiClient,t.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(e=t.config)!==null&&e!==void 0?e:this.config});this.sendPromise=r.then(()=>{});const l=await r;return this.processStreamResponse(l,n)}getHistory(t=!1){return t?cn(this.history):this.history}processStreamResponse(t,e){var n,r;return J(this,arguments,function*(){var a,u,c,d;const f=[];try{for(var m=!0,p=j(t),g;g=yield M(p.next()),a=g.done,!a;m=!0){d=g.value,m=!1;const h=d;if(an(h)){const C=(r=(n=h.candidates)===null||n===void 0?void 0:n[0])===null||r===void 0?void 0:r.content;C!==void 0&&f.push(C)}yield yield M(h)}}catch(h){u={error:h}}finally{try{!m&&!a&&(c=p.return)&&(yield M(c.call(p)))}finally{if(u)throw u.error}}this.recordHistory(e,f)})}recordHistory(t,e){let n=[];e.length>0&&e.every(r=>r.role==="model")?n=e:n.push({role:"model",parts:[]}),this.history.push(t),this.history.push(...n)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pn(i,t,e){const n={},r=s(t,["pageSize"]);e!==void 0&&r!=null&&o(e,["_query","pageSize"],r);const l=s(t,["pageToken"]);return e!==void 0&&l!=null&&o(e,["_query","pageToken"],l),n}function mn(i,t){const e={},n=s(t,["config"]);return n!=null&&o(e,["config"],pn(i,n,e)),e}function hn(i,t){const e={},n=s(t,["details"]);n!=null&&o(e,["details"],n);const r=s(t,["message"]);r!=null&&o(e,["message"],r);const l=s(t,["code"]);return l!=null&&o(e,["code"],l),e}function gn(i,t){const e={},n=s(t,["name"]);n!=null&&o(e,["name"],n);const r=s(t,["displayName"]);r!=null&&o(e,["displayName"],r);const l=s(t,["mimeType"]);l!=null&&o(e,["mimeType"],l);const a=s(t,["sizeBytes"]);a!=null&&o(e,["sizeBytes"],a);const u=s(t,["createTime"]);u!=null&&o(e,["createTime"],u);const c=s(t,["expirationTime"]);c!=null&&o(e,["expirationTime"],c);const d=s(t,["updateTime"]);d!=null&&o(e,["updateTime"],d);const f=s(t,["sha256Hash"]);f!=null&&o(e,["sha256Hash"],f);const m=s(t,["uri"]);m!=null&&o(e,["uri"],m);const p=s(t,["downloadUri"]);p!=null&&o(e,["downloadUri"],p);const g=s(t,["state"]);g!=null&&o(e,["state"],g);const h=s(t,["source"]);h!=null&&o(e,["source"],h);const C=s(t,["videoMetadata"]);C!=null&&o(e,["videoMetadata"],C);const y=s(t,["error"]);return y!=null&&o(e,["error"],hn(i,y)),e}function yn(i,t){const e={},n=s(t,["file"]);n!=null&&o(e,["file"],gn(i,n));const r=s(t,["config"]);return r!=null&&o(e,["config"],r),e}function Cn(i,t){const e={},n=s(t,["name"]);n!=null&&o(e,["_url","file"],ct(i,n));const r=s(t,["config"]);return r!=null&&o(e,["config"],r),e}function Tn(i,t){const e={},n=s(t,["name"]);n!=null&&o(e,["_url","file"],ct(i,n));const r=s(t,["config"]);return r!=null&&o(e,["config"],r),e}function vn(i,t){const e={},n=s(t,["details"]);n!=null&&o(e,["details"],n);const r=s(t,["message"]);r!=null&&o(e,["message"],r);const l=s(t,["code"]);return l!=null&&o(e,["code"],l),e}function ee(i,t){const e={},n=s(t,["name"]);n!=null&&o(e,["name"],n);const r=s(t,["displayName"]);r!=null&&o(e,["displayName"],r);const l=s(t,["mimeType"]);l!=null&&o(e,["mimeType"],l);const a=s(t,["sizeBytes"]);a!=null&&o(e,["sizeBytes"],a);const u=s(t,["createTime"]);u!=null&&o(e,["createTime"],u);const c=s(t,["expirationTime"]);c!=null&&o(e,["expirationTime"],c);const d=s(t,["updateTime"]);d!=null&&o(e,["updateTime"],d);const f=s(t,["sha256Hash"]);f!=null&&o(e,["sha256Hash"],f);const m=s(t,["uri"]);m!=null&&o(e,["uri"],m);const p=s(t,["downloadUri"]);p!=null&&o(e,["downloadUri"],p);const g=s(t,["state"]);g!=null&&o(e,["state"],g);const h=s(t,["source"]);h!=null&&o(e,["source"],h);const C=s(t,["videoMetadata"]);C!=null&&o(e,["videoMetadata"],C);const y=s(t,["error"]);return y!=null&&o(e,["error"],vn(i,y)),e}function In(i,t){const e={},n=s(t,["nextPageToken"]);n!=null&&o(e,["nextPageToken"],n);const r=s(t,["files"]);return r!=null&&(Array.isArray(r)?o(e,["files"],r.map(l=>ee(i,l))):o(e,["files"],r)),e}function En(){return{}}function _n(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Sn extends z{constructor(t){super(),this.apiClient=t,this.list=async(e={})=>new dt(Y.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(e),e)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(e=>ee(this.apiClient,e))}async listInternal(t){var e;let n,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=mn(this.apiClient,t);return r=E("files",a._url),l=a._query,delete a.config,delete a._url,delete a._query,n=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(u=>u.json()),n.then(u=>{const c=In(this.apiClient,u),d=new on;return Object.assign(d,c),d})}}async createInternal(t){var e;let n,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=yn(this.apiClient,t);return r=E("upload/v1beta/files",a._url),l=a._query,delete a.config,delete a._url,delete a._query,n=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(u=>u.json()),n.then(()=>{const u=En(),c=new sn;return Object.assign(c,u),c})}}async get(t){var e;let n,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Cn(this.apiClient,t);return r=E("files/{file}",a._url),l=a._query,delete a.config,delete a._url,delete a._query,n=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(u=>u.json()),n.then(u=>ee(this.apiClient,u))}}async delete(t){var e;let n,r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Tn(this.apiClient,t);return r=E("files/{file}",a._url),l=a._query,delete a.config,delete a._url,delete a._query,n=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(u=>u.json()),n.then(()=>{const u=_n(),c=new rn;return Object.assign(c,u),c})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function An(i,t){const e={};if(s(t,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const n=s(t,["thought"]);n!=null&&o(e,["thought"],n);const r=s(t,["codeExecutionResult"]);r!=null&&o(e,["codeExecutionResult"],r);const l=s(t,["executableCode"]);l!=null&&o(e,["executableCode"],l);const a=s(t,["fileData"]);a!=null&&o(e,["fileData"],a);const u=s(t,["functionCall"]);u!=null&&o(e,["functionCall"],u);const c=s(t,["functionResponse"]);c!=null&&o(e,["functionResponse"],c);const d=s(t,["inlineData"]);d!=null&&o(e,["inlineData"],d);const f=s(t,["text"]);return f!=null&&o(e,["text"],f),e}function wn(i,t){const e={},n=s(t,["videoMetadata"]);n!=null&&o(e,["videoMetadata"],n);const r=s(t,["thought"]);r!=null&&o(e,["thought"],r);const l=s(t,["codeExecutionResult"]);l!=null&&o(e,["codeExecutionResult"],l);const a=s(t,["executableCode"]);a!=null&&o(e,["executableCode"],a);const u=s(t,["fileData"]);u!=null&&o(e,["fileData"],u);const c=s(t,["functionCall"]);c!=null&&o(e,["functionCall"],c);const d=s(t,["functionResponse"]);d!=null&&o(e,["functionResponse"],d);const f=s(t,["inlineData"]);f!=null&&o(e,["inlineData"],f);const m=s(t,["text"]);return m!=null&&o(e,["text"],m),e}function Mn(i,t){const e={},n=s(t,["parts"]);n!=null&&(Array.isArray(n)?o(e,["parts"],n.map(l=>An(i,l))):o(e,["parts"],n));const r=s(t,["role"]);return r!=null&&o(e,["role"],r),e}function Pn(i,t){const e={},n=s(t,["parts"]);n!=null&&(Array.isArray(n)?o(e,["parts"],n.map(l=>wn(i,l))):o(e,["parts"],n));const r=s(t,["role"]);return r!=null&&o(e,["role"],r),e}function Rn(i,t){const e={},n=s(t,["example"]);n!=null&&o(e,["example"],n);const r=s(t,["pattern"]);r!=null&&o(e,["pattern"],r);const l=s(t,["default"]);l!=null&&o(e,["default"],l);const a=s(t,["maxLength"]);a!=null&&o(e,["maxLength"],a);const u=s(t,["minLength"]);u!=null&&o(e,["minLength"],u);const c=s(t,["minProperties"]);c!=null&&o(e,["minProperties"],c);const d=s(t,["maxProperties"]);d!=null&&o(e,["maxProperties"],d);const f=s(t,["anyOf"]);f!=null&&o(e,["anyOf"],f);const m=s(t,["description"]);m!=null&&o(e,["description"],m);const p=s(t,["enum"]);p!=null&&o(e,["enum"],p);const g=s(t,["format"]);g!=null&&o(e,["format"],g);const h=s(t,["items"]);h!=null&&o(e,["items"],h);const C=s(t,["maxItems"]);C!=null&&o(e,["maxItems"],C);const y=s(t,["maximum"]);y!=null&&o(e,["maximum"],y);const T=s(t,["minItems"]);T!=null&&o(e,["minItems"],T);const v=s(t,["minimum"]);v!=null&&o(e,["minimum"],v);const I=s(t,["nullable"]);I!=null&&o(e,["nullable"],I);const _=s(t,["properties"]);_!=null&&o(e,["properties"],_);const A=s(t,["propertyOrdering"]);A!=null&&o(e,["propertyOrdering"],A);const P=s(t,["required"]);P!=null&&o(e,["required"],P);const R=s(t,["title"]);R!=null&&o(e,["title"],R);const x=s(t,["type"]);return x!=null&&o(e,["type"],x),e}function xn(i,t){const e={};if(s(t,["response"])!==void 0)throw new Error("response parameter is not supported in Gemini API.");const n=s(t,["description"]);n!=null&&o(e,["description"],n);const r=s(t,["name"]);r!=null&&o(e,["name"],r);const l=s(t,["parameters"]);return l!=null&&o(e,["parameters"],l),e}function Dn(i,t){const e={},n=s(t,["response"]);n!=null&&o(e,["response"],Rn(i,n));const r=s(t,["description"]);r!=null&&o(e,["description"],r);const l=s(t,["name"]);l!=null&&o(e,["name"],l);const a=s(t,["parameters"]);return a!=null&&o(e,["parameters"],a),e}function Nn(){return{}}function Fn(){return{}}function kn(i,t){const e={},n=s(t,["mode"]);n!=null&&o(e,["mode"],n);const r=s(t,["dynamicThreshold"]);return r!=null&&o(e,["dynamicThreshold"],r),e}function Vn(i,t){const e={},n=s(t,["mode"]);n!=null&&o(e,["mode"],n);const r=s(t,["dynamicThreshold"]);return r!=null&&o(e,["dynamicThreshold"],r),e}function Un(i,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&o(e,["dynamicRetrievalConfig"],kn(i,n)),e}function Ln(i,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&o(e,["dynamicRetrievalConfig"],Vn(i,n)),e}function Gn(i,t){const e={},n=s(t,["functionDeclarations"]);if(n!=null&&(Array.isArray(n)?o(e,["functionDeclarations"],n.map(u=>xn(i,u))):o(e,["functionDeclarations"],n)),s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");s(t,["googleSearch"])!=null&&o(e,["googleSearch"],Nn());const l=s(t,["googleSearchRetrieval"]);l!=null&&o(e,["googleSearchRetrieval"],Un(i,l));const a=s(t,["codeExecution"]);return a!=null&&o(e,["codeExecution"],a),e}function qn(i,t){const e={},n=s(t,["functionDeclarations"]);n!=null&&(Array.isArray(n)?o(e,["functionDeclarations"],n.map(c=>Dn(i,c))):o(e,["functionDeclarations"],n));const r=s(t,["retrieval"]);r!=null&&o(e,["retrieval"],r),s(t,["googleSearch"])!=null&&o(e,["googleSearch"],Fn());const a=s(t,["googleSearchRetrieval"]);a!=null&&o(e,["googleSearchRetrieval"],Ln(i,a));const u=s(t,["codeExecution"]);return u!=null&&o(e,["codeExecution"],u),e}function $n(i,t){const e={},n=s(t,["handle"]);if(n!=null&&o(e,["handle"],n),s(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Bn(i,t){const e={},n=s(t,["handle"]);n!=null&&o(e,["handle"],n);const r=s(t,["transparent"]);return r!=null&&o(e,["transparent"],r),e}function Hn(){return{}}function ze(){return{}}function Wn(i,t){const e={},n=s(t,["disabled"]);n!=null&&o(e,["disabled"],n);const r=s(t,["startOfSpeechSensitivity"]);r!=null&&o(e,["startOfSpeechSensitivity"],r);const l=s(t,["endOfSpeechSensitivity"]);l!=null&&o(e,["endOfSpeechSensitivity"],l);const a=s(t,["prefixPaddingMs"]);a!=null&&o(e,["prefixPaddingMs"],a);const u=s(t,["silenceDurationMs"]);return u!=null&&o(e,["silenceDurationMs"],u),e}function Yn(i,t){const e={},n=s(t,["disabled"]);n!=null&&o(e,["disabled"],n);const r=s(t,["startOfSpeechSensitivity"]);r!=null&&o(e,["startOfSpeechSensitivity"],r);const l=s(t,["endOfSpeechSensitivity"]);l!=null&&o(e,["endOfSpeechSensitivity"],l);const a=s(t,["prefixPaddingMs"]);a!=null&&o(e,["prefixPaddingMs"],a);const u=s(t,["silenceDurationMs"]);return u!=null&&o(e,["silenceDurationMs"],u),e}function Kn(i,t){const e={},n=s(t,["automaticActivityDetection"]);n!=null&&o(e,["automaticActivityDetection"],Wn(i,n));const r=s(t,["activityHandling"]);r!=null&&o(e,["activityHandling"],r);const l=s(t,["turnCoverage"]);return l!=null&&o(e,["turnCoverage"],l),e}function Jn(i,t){const e={},n=s(t,["automaticActivityDetection"]);n!=null&&o(e,["automaticActivityDetection"],Yn(i,n));const r=s(t,["activityHandling"]);r!=null&&o(e,["activityHandling"],r);const l=s(t,["turnCoverage"]);return l!=null&&o(e,["turnCoverage"],l),e}function zn(i,t){const e={},n=s(t,["targetTokens"]);return n!=null&&o(e,["targetTokens"],n),e}function Xn(i,t){const e={},n=s(t,["targetTokens"]);return n!=null&&o(e,["targetTokens"],n),e}function Qn(i,t){const e={},n=s(t,["triggerTokens"]);n!=null&&o(e,["triggerTokens"],n);const r=s(t,["slidingWindow"]);return r!=null&&o(e,["slidingWindow"],zn(i,r)),e}function On(i,t){const e={},n=s(t,["triggerTokens"]);n!=null&&o(e,["triggerTokens"],n);const r=s(t,["slidingWindow"]);return r!=null&&o(e,["slidingWindow"],Xn(i,r)),e}function Zn(i,t,e){const n={},r=s(t,["generationConfig"]);e!==void 0&&r!=null&&o(e,["setup","generationConfig"],r);const l=s(t,["responseModalities"]);e!==void 0&&l!=null&&o(e,["setup","generationConfig","responseModalities"],l);const a=s(t,["temperature"]);e!==void 0&&a!=null&&o(e,["setup","generationConfig","temperature"],a);const u=s(t,["topP"]);e!==void 0&&u!=null&&o(e,["setup","generationConfig","topP"],u);const c=s(t,["topK"]);e!==void 0&&c!=null&&o(e,["setup","generationConfig","topK"],c);const d=s(t,["maxOutputTokens"]);e!==void 0&&d!=null&&o(e,["setup","generationConfig","maxOutputTokens"],d);const f=s(t,["mediaResolution"]);e!==void 0&&f!=null&&o(e,["setup","generationConfig","mediaResolution"],f);const m=s(t,["seed"]);e!==void 0&&m!=null&&o(e,["setup","generationConfig","seed"],m);const p=s(t,["speechConfig"]);e!==void 0&&p!=null&&o(e,["setup","generationConfig","speechConfig"],p);const g=s(t,["systemInstruction"]);e!==void 0&&g!=null&&o(e,["setup","systemInstruction"],Mn(i,D(i,g)));const h=s(t,["tools"]);e!==void 0&&h!=null&&(Array.isArray(h)?o(e,["setup","tools"],N(i,N(i,h).map(I=>Gn(i,X(i,I))))):o(e,["setup","tools"],N(i,h)));const C=s(t,["sessionResumption"]);if(e!==void 0&&C!=null&&o(e,["setup","sessionResumption"],$n(i,C)),s(t,["inputAudioTranscription"])!==void 0)throw new Error("inputAudioTranscription parameter is not supported in Gemini API.");const y=s(t,["outputAudioTranscription"]);e!==void 0&&y!=null&&o(e,["setup","outputAudioTranscription"],Hn());const T=s(t,["realtimeInputConfig"]);e!==void 0&&T!=null&&o(e,["setup","realtimeInputConfig"],Kn(i,T));const v=s(t,["contextWindowCompression"]);return e!==void 0&&v!=null&&o(e,["setup","contextWindowCompression"],Qn(i,v)),n}function bn(i,t,e){const n={},r=s(t,["generationConfig"]);e!==void 0&&r!=null&&o(e,["setup","generationConfig"],r);const l=s(t,["responseModalities"]);e!==void 0&&l!=null&&o(e,["setup","generationConfig","responseModalities"],l);const a=s(t,["temperature"]);e!==void 0&&a!=null&&o(e,["setup","generationConfig","temperature"],a);const u=s(t,["topP"]);e!==void 0&&u!=null&&o(e,["setup","generationConfig","topP"],u);const c=s(t,["topK"]);e!==void 0&&c!=null&&o(e,["setup","generationConfig","topK"],c);const d=s(t,["maxOutputTokens"]);e!==void 0&&d!=null&&o(e,["setup","generationConfig","maxOutputTokens"],d);const f=s(t,["mediaResolution"]);e!==void 0&&f!=null&&o(e,["setup","generationConfig","mediaResolution"],f);const m=s(t,["seed"]);e!==void 0&&m!=null&&o(e,["setup","generationConfig","seed"],m);const p=s(t,["speechConfig"]);e!==void 0&&p!=null&&o(e,["setup","generationConfig","speechConfig"],p);const g=s(t,["systemInstruction"]);e!==void 0&&g!=null&&o(e,["setup","systemInstruction"],Pn(i,D(i,g)));const h=s(t,["tools"]);e!==void 0&&h!=null&&(Array.isArray(h)?o(e,["setup","tools"],N(i,N(i,h).map(_=>qn(i,X(i,_))))):o(e,["setup","tools"],N(i,h)));const C=s(t,["sessionResumption"]);e!==void 0&&C!=null&&o(e,["setup","sessionResumption"],Bn(i,C));const y=s(t,["inputAudioTranscription"]);e!==void 0&&y!=null&&o(e,["setup","inputAudioTranscription"],ze());const T=s(t,["outputAudioTranscription"]);e!==void 0&&T!=null&&o(e,["setup","outputAudioTranscription"],ze());const v=s(t,["realtimeInputConfig"]);e!==void 0&&v!=null&&o(e,["setup","realtimeInputConfig"],Jn(i,v));const I=s(t,["contextWindowCompression"]);return e!==void 0&&I!=null&&o(e,["setup","contextWindowCompression"],On(i,I)),n}function jn(i,t){const e={},n=s(t,["model"]);n!=null&&o(e,["setup","model"],w(i,n));const r=s(t,["config"]);return r!=null&&o(e,["config"],Zn(i,r,e)),e}function eo(i,t){const e={},n=s(t,["model"]);n!=null&&o(e,["setup","model"],w(i,n));const r=s(t,["config"]);return r!=null&&o(e,["config"],bn(i,r,e)),e}function to(){return{}}function no(){return{}}function oo(i,t){const e={},n=s(t,["thought"]);n!=null&&o(e,["thought"],n);const r=s(t,["codeExecutionResult"]);r!=null&&o(e,["codeExecutionResult"],r);const l=s(t,["executableCode"]);l!=null&&o(e,["executableCode"],l);const a=s(t,["fileData"]);a!=null&&o(e,["fileData"],a);const u=s(t,["functionCall"]);u!=null&&o(e,["functionCall"],u);const c=s(t,["functionResponse"]);c!=null&&o(e,["functionResponse"],c);const d=s(t,["inlineData"]);d!=null&&o(e,["inlineData"],d);const f=s(t,["text"]);return f!=null&&o(e,["text"],f),e}function io(i,t){const e={},n=s(t,["videoMetadata"]);n!=null&&o(e,["videoMetadata"],n);const r=s(t,["thought"]);r!=null&&o(e,["thought"],r);const l=s(t,["codeExecutionResult"]);l!=null&&o(e,["codeExecutionResult"],l);const a=s(t,["executableCode"]);a!=null&&o(e,["executableCode"],a);const u=s(t,["fileData"]);u!=null&&o(e,["fileData"],u);const c=s(t,["functionCall"]);c!=null&&o(e,["functionCall"],c);const d=s(t,["functionResponse"]);d!=null&&o(e,["functionResponse"],d);const f=s(t,["inlineData"]);f!=null&&o(e,["inlineData"],f);const m=s(t,["text"]);return m!=null&&o(e,["text"],m),e}function so(i,t){const e={},n=s(t,["parts"]);n!=null&&(Array.isArray(n)?o(e,["parts"],n.map(l=>oo(i,l))):o(e,["parts"],n));const r=s(t,["role"]);return r!=null&&o(e,["role"],r),e}function ro(i,t){const e={},n=s(t,["parts"]);n!=null&&(Array.isArray(n)?o(e,["parts"],n.map(l=>io(i,l))):o(e,["parts"],n));const r=s(t,["role"]);return r!=null&&o(e,["role"],r),e}function Xe(i,t){const e={},n=s(t,["text"]);n!=null&&o(e,["text"],n);const r=s(t,["finished"]);return r!=null&&o(e,["finished"],r),e}function Qe(i,t){const e={},n=s(t,["text"]);n!=null&&o(e,["text"],n);const r=s(t,["finished"]);return r!=null&&o(e,["finished"],r),e}function lo(i,t){const e={},n=s(t,["modelTurn"]);n!=null&&o(e,["modelTurn"],so(i,n));const r=s(t,["turnComplete"]);r!=null&&o(e,["turnComplete"],r);const l=s(t,["interrupted"]);l!=null&&o(e,["interrupted"],l);const a=s(t,["generationComplete"]);a!=null&&o(e,["generationComplete"],a);const u=s(t,["inputTranscription"]);u!=null&&o(e,["inputTranscription"],Xe(i,u));const c=s(t,["outputTranscription"]);return c!=null&&o(e,["outputTranscription"],Xe(i,c)),e}function ao(i,t){const e={},n=s(t,["modelTurn"]);n!=null&&o(e,["modelTurn"],ro(i,n));const r=s(t,["turnComplete"]);r!=null&&o(e,["turnComplete"],r);const l=s(t,["interrupted"]);l!=null&&o(e,["interrupted"],l);const a=s(t,["generationComplete"]);a!=null&&o(e,["generationComplete"],a);const u=s(t,["inputTranscription"]);u!=null&&o(e,["inputTranscription"],Qe(i,u));const c=s(t,["outputTranscription"]);return c!=null&&o(e,["outputTranscription"],Qe(i,c)),e}function uo(i,t){const e={},n=s(t,["id"]);n!=null&&o(e,["id"],n);const r=s(t,["args"]);r!=null&&o(e,["args"],r);const l=s(t,["name"]);return l!=null&&o(e,["name"],l),e}function co(i,t){const e={},n=s(t,["args"]);n!=null&&o(e,["args"],n);const r=s(t,["name"]);return r!=null&&o(e,["name"],r),e}function fo(i,t){const e={},n=s(t,["functionCalls"]);return n!=null&&(Array.isArray(n)?o(e,["functionCalls"],n.map(r=>uo(i,r))):o(e,["functionCalls"],n)),e}function po(i,t){const e={},n=s(t,["functionCalls"]);return n!=null&&(Array.isArray(n)?o(e,["functionCalls"],n.map(r=>co(i,r))):o(e,["functionCalls"],n)),e}function mo(i,t){const e={},n=s(t,["ids"]);return n!=null&&o(e,["ids"],n),e}function ho(i,t){const e={},n=s(t,["ids"]);return n!=null&&o(e,["ids"],n),e}function q(i,t){const e={},n=s(t,["modality"]);n!=null&&o(e,["modality"],n);const r=s(t,["tokenCount"]);return r!=null&&o(e,["tokenCount"],r),e}function $(i,t){const e={},n=s(t,["modality"]);n!=null&&o(e,["modality"],n);const r=s(t,["tokenCount"]);return r!=null&&o(e,["tokenCount"],r),e}function go(i,t){const e={},n=s(t,["promptTokenCount"]);n!=null&&o(e,["promptTokenCount"],n);const r=s(t,["cachedContentTokenCount"]);r!=null&&o(e,["cachedContentTokenCount"],r);const l=s(t,["responseTokenCount"]);l!=null&&o(e,["responseTokenCount"],l);const a=s(t,["toolUsePromptTokenCount"]);a!=null&&o(e,["toolUsePromptTokenCount"],a);const u=s(t,["thoughtsTokenCount"]);u!=null&&o(e,["thoughtsTokenCount"],u);const c=s(t,["totalTokenCount"]);c!=null&&o(e,["totalTokenCount"],c);const d=s(t,["promptTokensDetails"]);d!=null&&(Array.isArray(d)?o(e,["promptTokensDetails"],d.map(g=>q(i,g))):o(e,["promptTokensDetails"],d));const f=s(t,["cacheTokensDetails"]);f!=null&&(Array.isArray(f)?o(e,["cacheTokensDetails"],f.map(g=>q(i,g))):o(e,["cacheTokensDetails"],f));const m=s(t,["responseTokensDetails"]);m!=null&&(Array.isArray(m)?o(e,["responseTokensDetails"],m.map(g=>q(i,g))):o(e,["responseTokensDetails"],m));const p=s(t,["toolUsePromptTokensDetails"]);return p!=null&&(Array.isArray(p)?o(e,["toolUsePromptTokensDetails"],p.map(g=>q(i,g))):o(e,["toolUsePromptTokensDetails"],p)),e}function yo(i,t){const e={},n=s(t,["promptTokenCount"]);n!=null&&o(e,["promptTokenCount"],n);const r=s(t,["cachedContentTokenCount"]);r!=null&&o(e,["cachedContentTokenCount"],r);const l=s(t,["candidatesTokenCount"]);l!=null&&o(e,["responseTokenCount"],l);const a=s(t,["toolUsePromptTokenCount"]);a!=null&&o(e,["toolUsePromptTokenCount"],a);const u=s(t,["thoughtsTokenCount"]);u!=null&&o(e,["thoughtsTokenCount"],u);const c=s(t,["totalTokenCount"]);c!=null&&o(e,["totalTokenCount"],c);const d=s(t,["promptTokensDetails"]);d!=null&&(Array.isArray(d)?o(e,["promptTokensDetails"],d.map(h=>$(i,h))):o(e,["promptTokensDetails"],d));const f=s(t,["cacheTokensDetails"]);f!=null&&(Array.isArray(f)?o(e,["cacheTokensDetails"],f.map(h=>$(i,h))):o(e,["cacheTokensDetails"],f));const m=s(t,["candidatesTokensDetails"]);m!=null&&(Array.isArray(m)?o(e,["responseTokensDetails"],m.map(h=>$(i,h))):o(e,["responseTokensDetails"],m));const p=s(t,["toolUsePromptTokensDetails"]);p!=null&&(Array.isArray(p)?o(e,["toolUsePromptTokensDetails"],p.map(h=>$(i,h))):o(e,["toolUsePromptTokensDetails"],p));const g=s(t,["trafficType"]);return g!=null&&o(e,["trafficType"],g),e}function Co(i,t){const e={},n=s(t,["timeLeft"]);return n!=null&&o(e,["timeLeft"],n),e}function To(i,t){const e={},n=s(t,["timeLeft"]);return n!=null&&o(e,["timeLeft"],n),e}function vo(i,t){const e={},n=s(t,["newHandle"]);n!=null&&o(e,["newHandle"],n);const r=s(t,["resumable"]);r!=null&&o(e,["resumable"],r);const l=s(t,["lastConsumedClientMessageIndex"]);return l!=null&&o(e,["lastConsumedClientMessageIndex"],l),e}function Io(i,t){const e={},n=s(t,["newHandle"]);n!=null&&o(e,["newHandle"],n);const r=s(t,["resumable"]);r!=null&&o(e,["resumable"],r);const l=s(t,["lastConsumedClientMessageIndex"]);return l!=null&&o(e,["lastConsumedClientMessageIndex"],l),e}function Eo(i,t){const e={};s(t,["setupComplete"])!=null&&o(e,["setupComplete"],to());const r=s(t,["serverContent"]);r!=null&&o(e,["serverContent"],lo(i,r));const l=s(t,["toolCall"]);l!=null&&o(e,["toolCall"],fo(i,l));const a=s(t,["toolCallCancellation"]);a!=null&&o(e,["toolCallCancellation"],mo(i,a));const u=s(t,["usageMetadata"]);u!=null&&o(e,["usageMetadata"],go(i,u));const c=s(t,["goAway"]);c!=null&&o(e,["goAway"],Co(i,c));const d=s(t,["sessionResumptionUpdate"]);return d!=null&&o(e,["sessionResumptionUpdate"],vo(i,d)),e}function _o(i,t){const e={};s(t,["setupComplete"])!=null&&o(e,["setupComplete"],no());const r=s(t,["serverContent"]);r!=null&&o(e,["serverContent"],ao(i,r));const l=s(t,["toolCall"]);l!=null&&o(e,["toolCall"],po(i,l));const a=s(t,["toolCallCancellation"]);a!=null&&o(e,["toolCallCancellation"],ho(i,a));const u=s(t,["usageMetadata"]);u!=null&&o(e,["usageMetadata"],yo(i,u));const c=s(t,["goAway"]);c!=null&&o(e,["goAway"],To(i,c));const d=s(t,["sessionResumptionUpdate"]);return d!=null&&o(e,["sessionResumptionUpdate"],Io(i,d)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function So(i,t){const e={};if(s(t,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const n=s(t,["thought"]);n!=null&&o(e,["thought"],n);const r=s(t,["codeExecutionResult"]);r!=null&&o(e,["codeExecutionResult"],r);const l=s(t,["executableCode"]);l!=null&&o(e,["executableCode"],l);const a=s(t,["fileData"]);a!=null&&o(e,["fileData"],a);const u=s(t,["functionCall"]);u!=null&&o(e,["functionCall"],u);const c=s(t,["functionResponse"]);c!=null&&o(e,["functionResponse"],c);const d=s(t,["inlineData"]);d!=null&&o(e,["inlineData"],d);const f=s(t,["text"]);return f!=null&&o(e,["text"],f),e}function Q(i,t){const e={},n=s(t,["parts"]);n!=null&&(Array.isArray(n)?o(e,["parts"],n.map(l=>So(i,l))):o(e,["parts"],n));const r=s(t,["role"]);return r!=null&&o(e,["role"],r),e}function Ao(i,t){const e={};if(s(t,["example"])!==void 0)throw new Error("example parameter is not supported in Gemini API.");if(s(t,["pattern"])!==void 0)throw new Error("pattern parameter is not supported in Gemini API.");if(s(t,["default"])!==void 0)throw new Error("default parameter is not supported in Gemini API.");if(s(t,["maxLength"])!==void 0)throw new Error("maxLength parameter is not supported in Gemini API.");if(s(t,["minLength"])!==void 0)throw new Error("minLength parameter is not supported in Gemini API.");if(s(t,["minProperties"])!==void 0)throw new Error("minProperties parameter is not supported in Gemini API.");if(s(t,["maxProperties"])!==void 0)throw new Error("maxProperties parameter is not supported in Gemini API.");const n=s(t,["anyOf"]);n!=null&&o(e,["anyOf"],n);const r=s(t,["description"]);r!=null&&o(e,["description"],r);const l=s(t,["enum"]);l!=null&&o(e,["enum"],l);const a=s(t,["format"]);a!=null&&o(e,["format"],a);const u=s(t,["items"]);u!=null&&o(e,["items"],u);const c=s(t,["maxItems"]);c!=null&&o(e,["maxItems"],c);const d=s(t,["maximum"]);d!=null&&o(e,["maximum"],d);const f=s(t,["minItems"]);f!=null&&o(e,["minItems"],f);const m=s(t,["minimum"]);m!=null&&o(e,["minimum"],m);const p=s(t,["nullable"]);p!=null&&o(e,["nullable"],p);const g=s(t,["properties"]);g!=null&&o(e,["properties"],g);const h=s(t,["propertyOrdering"]);h!=null&&o(e,["propertyOrdering"],h);const C=s(t,["required"]);C!=null&&o(e,["required"],C);const y=s(t,["title"]);y!=null&&o(e,["title"],y);const T=s(t,["type"]);return T!=null&&o(e,["type"],T),e}function wo(i,t){const e={};if(s(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=s(t,["category"]);n!=null&&o(e,["category"],n);const r=s(t,["threshold"]);return r!=null&&o(e,["threshold"],r),e}function Mo(i,t){const e={};if(s(t,["response"])!==void 0)throw new Error("response parameter is not supported in Gemini API.");const n=s(t,["description"]);n!=null&&o(e,["description"],n);const r=s(t,["name"]);r!=null&&o(e,["name"],r);const l=s(t,["parameters"]);return l!=null&&o(e,["parameters"],l),e}function Po(){return{}}function Ro(i,t){const e={},n=s(t,["mode"]);n!=null&&o(e,["mode"],n);const r=s(t,["dynamicThreshold"]);return r!=null&&o(e,["dynamicThreshold"],r),e}function xo(i,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&o(e,["dynamicRetrievalConfig"],Ro(i,n)),e}function Do(i,t){const e={},n=s(t,["functionDeclarations"]);if(n!=null&&(Array.isArray(n)?o(e,["functionDeclarations"],n.map(u=>Mo(i,u))):o(e,["functionDeclarations"],n)),s(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");s(t,["googleSearch"])!=null&&o(e,["googleSearch"],Po());const l=s(t,["googleSearchRetrieval"]);l!=null&&o(e,["googleSearchRetrieval"],xo(i,l));const a=s(t,["codeExecution"]);return a!=null&&o(e,["codeExecution"],a),e}function No(i,t){const e={},n=s(t,["mode"]);n!=null&&o(e,["mode"],n);const r=s(t,["allowedFunctionNames"]);return r!=null&&o(e,["allowedFunctionNames"],r),e}function Fo(i,t){const e={},n=s(t,["functionCallingConfig"]);return n!=null&&o(e,["functionCallingConfig"],No(i,n)),e}function ko(i,t){const e={},n=s(t,["voiceName"]);return n!=null&&o(e,["voiceName"],n),e}function Vo(i,t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&o(e,["prebuiltVoiceConfig"],ko(i,n)),e}function Uo(i,t){const e={},n=s(t,["voiceConfig"]);n!=null&&o(e,["voiceConfig"],Vo(i,n));const r=s(t,["languageCode"]);return r!=null&&o(e,["languageCode"],r),e}function Lo(i,t){const e={},n=s(t,["includeThoughts"]);n!=null&&o(e,["includeThoughts"],n);const r=s(t,["thinkingBudget"]);return r!=null&&o(e,["thinkingBudget"],r),e}function Go(i,t,e){const n={},r=s(t,["systemInstruction"]);e!==void 0&&r!=null&&o(e,["systemInstruction"],Q(i,D(i,r)));const l=s(t,["temperature"]);l!=null&&o(n,["temperature"],l);const a=s(t,["topP"]);a!=null&&o(n,["topP"],a);const u=s(t,["topK"]);u!=null&&o(n,["topK"],u);const c=s(t,["candidateCount"]);c!=null&&o(n,["candidateCount"],c);const d=s(t,["maxOutputTokens"]);d!=null&&o(n,["maxOutputTokens"],d);const f=s(t,["stopSequences"]);f!=null&&o(n,["stopSequences"],f);const m=s(t,["responseLogprobs"]);m!=null&&o(n,["responseLogprobs"],m);const p=s(t,["logprobs"]);p!=null&&o(n,["logprobs"],p);const g=s(t,["presencePenalty"]);g!=null&&o(n,["presencePenalty"],g);const h=s(t,["frequencyPenalty"]);h!=null&&o(n,["frequencyPenalty"],h);const C=s(t,["seed"]);C!=null&&o(n,["seed"],C);const y=s(t,["responseMimeType"]);y!=null&&o(n,["responseMimeType"],y);const T=s(t,["responseSchema"]);if(T!=null&&o(n,["responseSchema"],Ao(i,at(i,T))),s(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(s(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const v=s(t,["safetySettings"]);e!==void 0&&v!=null&&(Array.isArray(v)?o(e,["safetySettings"],v.map(V=>wo(i,V))):o(e,["safetySettings"],v));const I=s(t,["tools"]);e!==void 0&&I!=null&&(Array.isArray(I)?o(e,["tools"],N(i,N(i,I).map(V=>Do(i,X(i,V))))):o(e,["tools"],N(i,I)));const _=s(t,["toolConfig"]);if(e!==void 0&&_!=null&&o(e,["toolConfig"],Fo(i,_)),s(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const A=s(t,["cachedContent"]);e!==void 0&&A!=null&&o(e,["cachedContent"],F(i,A));const P=s(t,["responseModalities"]);P!=null&&o(n,["responseModalities"],P);const R=s(t,["mediaResolution"]);R!=null&&o(n,["mediaResolution"],R);const x=s(t,["speechConfig"]);if(x!=null&&o(n,["speechConfig"],Uo(i,ut(i,x))),s(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const L=s(t,["thinkingConfig"]);return L!=null&&o(n,["thinkingConfig"],Lo(i,L)),n}function Oe(i,t){const e={},n=s(t,["model"]);n!=null&&o(e,["_url","model"],w(i,n));const r=s(t,["contents"]);r!=null&&(Array.isArray(r)?o(e,["contents"],S(i,S(i,r).map(a=>Q(i,a)))):o(e,["contents"],S(i,r)));const l=s(t,["config"]);return l!=null&&o(e,["generationConfig"],Go(i,l,e)),e}function qo(i,t,e){const n={},r=s(t,["taskType"]);e!==void 0&&r!=null&&o(e,["requests[]","taskType"],r);const l=s(t,["title"]);e!==void 0&&l!=null&&o(e,["requests[]","title"],l);const a=s(t,["outputDimensionality"]);if(e!==void 0&&a!=null&&o(e,["requests[]","outputDimensionality"],a),s(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(s(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function $o(i,t){const e={},n=s(t,["model"]);n!=null&&o(e,["_url","model"],w(i,n));const r=s(t,["contents"]);r!=null&&o(e,["requests[]","content"],lt(i,r));const l=s(t,["config"]);l!=null&&o(e,["config"],qo(i,l,e));const a=s(t,["model"]);return a!==void 0&&o(e,["requests[]","model"],w(i,a)),e}function Bo(i,t,e){const n={};if(s(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(s(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=s(t,["numberOfImages"]);e!==void 0&&r!=null&&o(e,["parameters","sampleCount"],r);const l=s(t,["aspectRatio"]);e!==void 0&&l!=null&&o(e,["parameters","aspectRatio"],l);const a=s(t,["guidanceScale"]);if(e!==void 0&&a!=null&&o(e,["parameters","guidanceScale"],a),s(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const u=s(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&o(e,["parameters","safetySetting"],u);const c=s(t,["personGeneration"]);e!==void 0&&c!=null&&o(e,["parameters","personGeneration"],c);const d=s(t,["includeSafetyAttributes"]);e!==void 0&&d!=null&&o(e,["parameters","includeSafetyAttributes"],d);const f=s(t,["includeRaiReason"]);e!==void 0&&f!=null&&o(e,["parameters","includeRaiReason"],f);const m=s(t,["language"]);e!==void 0&&m!=null&&o(e,["parameters","language"],m);const p=s(t,["outputMimeType"]);e!==void 0&&p!=null&&o(e,["parameters","outputOptions","mimeType"],p);const g=s(t,["outputCompressionQuality"]);if(e!==void 0&&g!=null&&o(e,["parameters","outputOptions","compressionQuality"],g),s(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(s(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function Ho(i,t){const e={},n=s(t,["model"]);n!=null&&o(e,["_url","model"],w(i,n));const r=s(t,["prompt"]);r!=null&&o(e,["instances[0]","prompt"],r);const l=s(t,["config"]);return l!=null&&o(e,["config"],Bo(i,l,e)),e}function Wo(i,t){const e={},n=s(t,["model"]);n!=null&&o(e,["_url","name"],w(i,n));const r=s(t,["config"]);return r!=null&&o(e,["config"],r),e}function Yo(i,t){const e={};if(s(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(s(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(s(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Ko(i,t){const e={},n=s(t,["model"]);n!=null&&o(e,["_url","model"],w(i,n));const r=s(t,["contents"]);r!=null&&(Array.isArray(r)?o(e,["contents"],S(i,S(i,r).map(a=>Q(i,a)))):o(e,["contents"],S(i,r)));const l=s(t,["config"]);return l!=null&&o(e,["config"],Yo(i,l)),e}function Jo(i,t){const e={};if(s(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=s(t,["imageBytes"]);n!=null&&o(e,["bytesBase64Encoded"],k(i,n));const r=s(t,["mimeType"]);return r!=null&&o(e,["mimeType"],r),e}function zo(i,t,e){const n={},r=s(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&o(e,["parameters","sampleCount"],r),s(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(s(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const l=s(t,["durationSeconds"]);if(e!==void 0&&l!=null&&o(e,["parameters","durationSeconds"],l),s(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=s(t,["aspectRatio"]);if(e!==void 0&&a!=null&&o(e,["parameters","aspectRatio"],a),s(t,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const u=s(t,["personGeneration"]);if(e!==void 0&&u!=null&&o(e,["parameters","personGeneration"],u),s(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=s(t,["negativePrompt"]);if(e!==void 0&&c!=null&&o(e,["parameters","negativePrompt"],c),s(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function Xo(i,t){const e={},n=s(t,["model"]);n!=null&&o(e,["_url","model"],w(i,n));const r=s(t,["prompt"]);r!=null&&o(e,["instances[0]","prompt"],r);const l=s(t,["image"]);l!=null&&o(e,["instances[0]","image"],Jo(i,l));const a=s(t,["config"]);return a!=null&&o(e,["config"],zo(i,a,e)),e}function Qo(i,t){const e={},n=s(t,["videoMetadata"]);n!=null&&o(e,["videoMetadata"],n);const r=s(t,["thought"]);r!=null&&o(e,["thought"],r);const l=s(t,["codeExecutionResult"]);l!=null&&o(e,["codeExecutionResult"],l);const a=s(t,["executableCode"]);a!=null&&o(e,["executableCode"],a);const u=s(t,["fileData"]);u!=null&&o(e,["fileData"],u);const c=s(t,["functionCall"]);c!=null&&o(e,["functionCall"],c);const d=s(t,["functionResponse"]);d!=null&&o(e,["functionResponse"],d);const f=s(t,["inlineData"]);f!=null&&o(e,["inlineData"],f);const m=s(t,["text"]);return m!=null&&o(e,["text"],m),e}function U(i,t){const e={},n=s(t,["parts"]);n!=null&&(Array.isArray(n)?o(e,["parts"],n.map(l=>Qo(i,l))):o(e,["parts"],n));const r=s(t,["role"]);return r!=null&&o(e,["role"],r),e}function pt(i,t){const e={},n=s(t,["example"]);n!=null&&o(e,["example"],n);const r=s(t,["pattern"]);r!=null&&o(e,["pattern"],r);const l=s(t,["default"]);l!=null&&o(e,["default"],l);const a=s(t,["maxLength"]);a!=null&&o(e,["maxLength"],a);const u=s(t,["minLength"]);u!=null&&o(e,["minLength"],u);const c=s(t,["minProperties"]);c!=null&&o(e,["minProperties"],c);const d=s(t,["maxProperties"]);d!=null&&o(e,["maxProperties"],d);const f=s(t,["anyOf"]);f!=null&&o(e,["anyOf"],f);const m=s(t,["description"]);m!=null&&o(e,["description"],m);const p=s(t,["enum"]);p!=null&&o(e,["enum"],p);const g=s(t,["format"]);g!=null&&o(e,["format"],g);const h=s(t,["items"]);h!=null&&o(e,["items"],h);const C=s(t,["maxItems"]);C!=null&&o(e,["maxItems"],C);const y=s(t,["maximum"]);y!=null&&o(e,["maximum"],y);const T=s(t,["minItems"]);T!=null&&o(e,["minItems"],T);const v=s(t,["minimum"]);v!=null&&o(e,["minimum"],v);const I=s(t,["nullable"]);I!=null&&o(e,["nullable"],I);const _=s(t,["properties"]);_!=null&&o(e,["properties"],_);const A=s(t,["propertyOrdering"]);A!=null&&o(e,["propertyOrdering"],A);const P=s(t,["required"]);P!=null&&o(e,["required"],P);const R=s(t,["title"]);R!=null&&o(e,["title"],R);const x=s(t,["type"]);return x!=null&&o(e,["type"],x),e}function Oo(i,t){const e={},n=s(t,["featureSelectionPreference"]);return n!=null&&o(e,["featureSelectionPreference"],n),e}function Zo(i,t){const e={},n=s(t,["method"]);n!=null&&o(e,["method"],n);const r=s(t,["category"]);r!=null&&o(e,["category"],r);const l=s(t,["threshold"]);return l!=null&&o(e,["threshold"],l),e}function bo(i,t){const e={},n=s(t,["response"]);n!=null&&o(e,["response"],pt(i,n));const r=s(t,["description"]);r!=null&&o(e,["description"],r);const l=s(t,["name"]);l!=null&&o(e,["name"],l);const a=s(t,["parameters"]);return a!=null&&o(e,["parameters"],a),e}function jo(){return{}}function ei(i,t){const e={},n=s(t,["mode"]);n!=null&&o(e,["mode"],n);const r=s(t,["dynamicThreshold"]);return r!=null&&o(e,["dynamicThreshold"],r),e}function ti(i,t){const e={},n=s(t,["dynamicRetrievalConfig"]);return n!=null&&o(e,["dynamicRetrievalConfig"],ei(i,n)),e}function mt(i,t){const e={},n=s(t,["functionDeclarations"]);n!=null&&(Array.isArray(n)?o(e,["functionDeclarations"],n.map(c=>bo(i,c))):o(e,["functionDeclarations"],n));const r=s(t,["retrieval"]);r!=null&&o(e,["retrieval"],r),s(t,["googleSearch"])!=null&&o(e,["googleSearch"],jo());const a=s(t,["googleSearchRetrieval"]);a!=null&&o(e,["googleSearchRetrieval"],ti(i,a));const u=s(t,["codeExecution"]);return u!=null&&o(e,["codeExecution"],u),e}function ni(i,t){const e={},n=s(t,["mode"]);n!=null&&o(e,["mode"],n);const r=s(t,["allowedFunctionNames"]);return r!=null&&o(e,["allowedFunctionNames"],r),e}function oi(i,t){const e={},n=s(t,["functionCallingConfig"]);return n!=null&&o(e,["functionCallingConfig"],ni(i,n)),e}function ii(i,t){const e={},n=s(t,["voiceName"]);return n!=null&&o(e,["voiceName"],n),e}function si(i,t){const e={},n=s(t,["prebuiltVoiceConfig"]);return n!=null&&o(e,["prebuiltVoiceConfig"],ii(i,n)),e}function ri(i,t){const e={},n=s(t,["voiceConfig"]);n!=null&&o(e,["voiceConfig"],si(i,n));const r=s(t,["languageCode"]);return r!=null&&o(e,["languageCode"],r),e}function li(i,t){const e={},n=s(t,["includeThoughts"]);n!=null&&o(e,["includeThoughts"],n);const r=s(t,["thinkingBudget"]);return r!=null&&o(e,["thinkingBudget"],r),e}function ai(i,t,e){const n={},r=s(t,["systemInstruction"]);e!==void 0&&r!=null&&o(e,["systemInstruction"],U(i,D(i,r)));const l=s(t,["temperature"]);l!=null&&o(n,["temperature"],l);const a=s(t,["topP"]);a!=null&&o(n,["topP"],a);const u=s(t,["topK"]);u!=null&&o(n,["topK"],u);const c=s(t,["candidateCount"]);c!=null&&o(n,["candidateCount"],c);const d=s(t,["maxOutputTokens"]);d!=null&&o(n,["maxOutputTokens"],d);const f=s(t,["stopSequences"]);f!=null&&o(n,["stopSequences"],f);const m=s(t,["responseLogprobs"]);m!=null&&o(n,["responseLogprobs"],m);const p=s(t,["logprobs"]);p!=null&&o(n,["logprobs"],p);const g=s(t,["presencePenalty"]);g!=null&&o(n,["presencePenalty"],g);const h=s(t,["frequencyPenalty"]);h!=null&&o(n,["frequencyPenalty"],h);const C=s(t,["seed"]);C!=null&&o(n,["seed"],C);const y=s(t,["responseMimeType"]);y!=null&&o(n,["responseMimeType"],y);const T=s(t,["responseSchema"]);T!=null&&o(n,["responseSchema"],pt(i,at(i,T)));const v=s(t,["routingConfig"]);v!=null&&o(n,["routingConfig"],v);const I=s(t,["modelSelectionConfig"]);I!=null&&o(n,["modelConfig"],Oo(i,I));const _=s(t,["safetySettings"]);e!==void 0&&_!=null&&(Array.isArray(_)?o(e,["safetySettings"],_.map(O=>Zo(i,O))):o(e,["safetySettings"],_));const A=s(t,["tools"]);e!==void 0&&A!=null&&(Array.isArray(A)?o(e,["tools"],N(i,N(i,A).map(O=>mt(i,X(i,O))))):o(e,["tools"],N(i,A)));const P=s(t,["toolConfig"]);e!==void 0&&P!=null&&o(e,["toolConfig"],oi(i,P));const R=s(t,["labels"]);e!==void 0&&R!=null&&o(e,["labels"],R);const x=s(t,["cachedContent"]);e!==void 0&&x!=null&&o(e,["cachedContent"],F(i,x));const L=s(t,["responseModalities"]);L!=null&&o(n,["responseModalities"],L);const V=s(t,["mediaResolution"]);V!=null&&o(n,["mediaResolution"],V);const te=s(t,["speechConfig"]);te!=null&&o(n,["speechConfig"],ri(i,ut(i,te)));const ne=s(t,["audioTimestamp"]);ne!=null&&o(n,["audioTimestamp"],ne);const oe=s(t,["thinkingConfig"]);return oe!=null&&o(n,["thinkingConfig"],li(i,oe)),n}function Ze(i,t){const e={},n=s(t,["model"]);n!=null&&o(e,["_url","model"],w(i,n));const r=s(t,["contents"]);r!=null&&(Array.isArray(r)?o(e,["contents"],S(i,S(i,r).map(a=>U(i,a)))):o(e,["contents"],S(i,r)));const l=s(t,["config"]);return l!=null&&o(e,["generationConfig"],ai(i,l,e)),e}function ui(i,t,e){const n={},r=s(t,["taskType"]);e!==void 0&&r!=null&&o(e,["instances[]","task_type"],r);const l=s(t,["title"]);e!==void 0&&l!=null&&o(e,["instances[]","title"],l);const a=s(t,["outputDimensionality"]);e!==void 0&&a!=null&&o(e,["parameters","outputDimensionality"],a);const u=s(t,["mimeType"]);e!==void 0&&u!=null&&o(e,["instances[]","mimeType"],u);const c=s(t,["autoTruncate"]);return e!==void 0&&c!=null&&o(e,["parameters","autoTruncate"],c),n}function ci(i,t){const e={},n=s(t,["model"]);n!=null&&o(e,["_url","model"],w(i,n));const r=s(t,["contents"]);r!=null&&o(e,["instances[]","content"],lt(i,r));const l=s(t,["config"]);return l!=null&&o(e,["config"],ui(i,l,e)),e}function di(i,t,e){const n={},r=s(t,["outputGcsUri"]);e!==void 0&&r!=null&&o(e,["parameters","storageUri"],r);const l=s(t,["negativePrompt"]);e!==void 0&&l!=null&&o(e,["parameters","negativePrompt"],l);const a=s(t,["numberOfImages"]);e!==void 0&&a!=null&&o(e,["parameters","sampleCount"],a);const u=s(t,["aspectRatio"]);e!==void 0&&u!=null&&o(e,["parameters","aspectRatio"],u);const c=s(t,["guidanceScale"]);e!==void 0&&c!=null&&o(e,["parameters","guidanceScale"],c);const d=s(t,["seed"]);e!==void 0&&d!=null&&o(e,["parameters","seed"],d);const f=s(t,["safetyFilterLevel"]);e!==void 0&&f!=null&&o(e,["parameters","safetySetting"],f);const m=s(t,["personGeneration"]);e!==void 0&&m!=null&&o(e,["parameters","personGeneration"],m);const p=s(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&o(e,["parameters","includeSafetyAttributes"],p);const g=s(t,["includeRaiReason"]);e!==void 0&&g!=null&&o(e,["parameters","includeRaiReason"],g);const h=s(t,["language"]);e!==void 0&&h!=null&&o(e,["parameters","language"],h);const C=s(t,["outputMimeType"]);e!==void 0&&C!=null&&o(e,["parameters","outputOptions","mimeType"],C);const y=s(t,["outputCompressionQuality"]);e!==void 0&&y!=null&&o(e,["parameters","outputOptions","compressionQuality"],y);const T=s(t,["addWatermark"]);e!==void 0&&T!=null&&o(e,["parameters","addWatermark"],T);const v=s(t,["enhancePrompt"]);return e!==void 0&&v!=null&&o(e,["parameters","enhancePrompt"],v),n}function fi(i,t){const e={},n=s(t,["model"]);n!=null&&o(e,["_url","model"],w(i,n));const r=s(t,["prompt"]);r!=null&&o(e,["instances[0]","prompt"],r);const l=s(t,["config"]);return l!=null&&o(e,["config"],di(i,l,e)),e}function pi(i,t){const e={},n=s(t,["model"]);n!=null&&o(e,["_url","name"],w(i,n));const r=s(t,["config"]);return r!=null&&o(e,["config"],r),e}function mi(i,t,e){const n={},r=s(t,["systemInstruction"]);e!==void 0&&r!=null&&o(e,["systemInstruction"],U(i,D(i,r)));const l=s(t,["tools"]);e!==void 0&&l!=null&&(Array.isArray(l)?o(e,["tools"],l.map(u=>mt(i,u))):o(e,["tools"],l));const a=s(t,["generationConfig"]);return e!==void 0&&a!=null&&o(e,["generationConfig"],a),n}function hi(i,t){const e={},n=s(t,["model"]);n!=null&&o(e,["_url","model"],w(i,n));const r=s(t,["contents"]);r!=null&&(Array.isArray(r)?o(e,["contents"],S(i,S(i,r).map(a=>U(i,a)))):o(e,["contents"],S(i,r)));const l=s(t,["config"]);return l!=null&&o(e,["config"],mi(i,l,e)),e}function gi(i,t){const e={},n=s(t,["model"]);n!=null&&o(e,["_url","model"],w(i,n));const r=s(t,["contents"]);r!=null&&(Array.isArray(r)?o(e,["contents"],S(i,S(i,r).map(a=>U(i,a)))):o(e,["contents"],S(i,r)));const l=s(t,["config"]);return l!=null&&o(e,["config"],l),e}function yi(i,t){const e={},n=s(t,["gcsUri"]);n!=null&&o(e,["gcsUri"],n);const r=s(t,["imageBytes"]);r!=null&&o(e,["bytesBase64Encoded"],k(i,r));const l=s(t,["mimeType"]);return l!=null&&o(e,["mimeType"],l),e}function Ci(i,t,e){const n={},r=s(t,["numberOfVideos"]);e!==void 0&&r!=null&&o(e,["parameters","sampleCount"],r);const l=s(t,["outputGcsUri"]);e!==void 0&&l!=null&&o(e,["parameters","storageUri"],l);const a=s(t,["fps"]);e!==void 0&&a!=null&&o(e,["parameters","fps"],a);const u=s(t,["durationSeconds"]);e!==void 0&&u!=null&&o(e,["parameters","durationSeconds"],u);const c=s(t,["seed"]);e!==void 0&&c!=null&&o(e,["parameters","seed"],c);const d=s(t,["aspectRatio"]);e!==void 0&&d!=null&&o(e,["parameters","aspectRatio"],d);const f=s(t,["resolution"]);e!==void 0&&f!=null&&o(e,["parameters","resolution"],f);const m=s(t,["personGeneration"]);e!==void 0&&m!=null&&o(e,["parameters","personGeneration"],m);const p=s(t,["pubsubTopic"]);e!==void 0&&p!=null&&o(e,["parameters","pubsubTopic"],p);const g=s(t,["negativePrompt"]);e!==void 0&&g!=null&&o(e,["parameters","negativePrompt"],g);const h=s(t,["enhancePrompt"]);return e!==void 0&&h!=null&&o(e,["parameters","enhancePrompt"],h),n}function Ti(i,t){const e={},n=s(t,["model"]);n!=null&&o(e,["_url","model"],w(i,n));const r=s(t,["prompt"]);r!=null&&o(e,["instances[0]","prompt"],r);const l=s(t,["image"]);l!=null&&o(e,["instances[0]","image"],yi(i,l));const a=s(t,["config"]);return a!=null&&o(e,["config"],Ci(i,a,e)),e}function vi(i,t){const e={},n=s(t,["thought"]);n!=null&&o(e,["thought"],n);const r=s(t,["codeExecutionResult"]);r!=null&&o(e,["codeExecutionResult"],r);const l=s(t,["executableCode"]);l!=null&&o(e,["executableCode"],l);const a=s(t,["fileData"]);a!=null&&o(e,["fileData"],a);const u=s(t,["functionCall"]);u!=null&&o(e,["functionCall"],u);const c=s(t,["functionResponse"]);c!=null&&o(e,["functionResponse"],c);const d=s(t,["inlineData"]);d!=null&&o(e,["inlineData"],d);const f=s(t,["text"]);return f!=null&&o(e,["text"],f),e}function Ii(i,t){const e={},n=s(t,["parts"]);n!=null&&(Array.isArray(n)?o(e,["parts"],n.map(l=>vi(i,l))):o(e,["parts"],n));const r=s(t,["role"]);return r!=null&&o(e,["role"],r),e}function Ei(i,t){const e={},n=s(t,["citationSources"]);return n!=null&&o(e,["citations"],n),e}function _i(i,t){const e={},n=s(t,["content"]);n!=null&&o(e,["content"],Ii(i,n));const r=s(t,["citationMetadata"]);r!=null&&o(e,["citationMetadata"],Ei(i,r));const l=s(t,["tokenCount"]);l!=null&&o(e,["tokenCount"],l);const a=s(t,["finishReason"]);a!=null&&o(e,["finishReason"],a);const u=s(t,["avgLogprobs"]);u!=null&&o(e,["avgLogprobs"],u);const c=s(t,["groundingMetadata"]);c!=null&&o(e,["groundingMetadata"],c);const d=s(t,["index"]);d!=null&&o(e,["index"],d);const f=s(t,["logprobsResult"]);f!=null&&o(e,["logprobsResult"],f);const m=s(t,["safetyRatings"]);return m!=null&&o(e,["safetyRatings"],m),e}function be(i,t){const e={},n=s(t,["candidates"]);n!=null&&(Array.isArray(n)?o(e,["candidates"],n.map(u=>_i(i,u))):o(e,["candidates"],n));const r=s(t,["modelVersion"]);r!=null&&o(e,["modelVersion"],r);const l=s(t,["promptFeedback"]);l!=null&&o(e,["promptFeedback"],l);const a=s(t,["usageMetadata"]);return a!=null&&o(e,["usageMetadata"],a),e}function Si(i,t){const e={},n=s(t,["values"]);return n!=null&&o(e,["values"],n),e}function Ai(){return{}}function wi(i,t){const e={},n=s(t,["embeddings"]);return n!=null&&(Array.isArray(n)?o(e,["embeddings"],n.map(l=>Si(i,l))):o(e,["embeddings"],n)),s(t,["metadata"])!=null&&o(e,["metadata"],Ai()),e}function Mi(i,t){const e={},n=s(t,["bytesBase64Encoded"]);n!=null&&o(e,["imageBytes"],k(i,n));const r=s(t,["mimeType"]);return r!=null&&o(e,["mimeType"],r),e}function ht(i,t){const e={},n=s(t,["safetyAttributes","categories"]);n!=null&&o(e,["categories"],n);const r=s(t,["safetyAttributes","scores"]);r!=null&&o(e,["scores"],r);const l=s(t,["contentType"]);return l!=null&&o(e,["contentType"],l),e}function Pi(i,t){const e={},n=s(t,["_self"]);n!=null&&o(e,["image"],Mi(i,n));const r=s(t,["raiFilteredReason"]);r!=null&&o(e,["raiFilteredReason"],r);const l=s(t,["_self"]);return l!=null&&o(e,["safetyAttributes"],ht(i,l)),e}function Ri(i,t){const e={},n=s(t,["predictions"]);n!=null&&(Array.isArray(n)?o(e,["generatedImages"],n.map(l=>Pi(i,l))):o(e,["generatedImages"],n));const r=s(t,["positivePromptSafetyAttributes"]);return r!=null&&o(e,["positivePromptSafetyAttributes"],ht(i,r)),e}function xi(i,t){const e={},n=s(t,["baseModel"]);n!=null&&o(e,["baseModel"],n);const r=s(t,["createTime"]);r!=null&&o(e,["createTime"],r);const l=s(t,["updateTime"]);return l!=null&&o(e,["updateTime"],l),e}function Di(i,t){const e={},n=s(t,["name"]);n!=null&&o(e,["name"],n);const r=s(t,["displayName"]);r!=null&&o(e,["displayName"],r);const l=s(t,["description"]);l!=null&&o(e,["description"],l);const a=s(t,["version"]);a!=null&&o(e,["version"],a);const u=s(t,["_self"]);u!=null&&o(e,["tunedModelInfo"],xi(i,u));const c=s(t,["inputTokenLimit"]);c!=null&&o(e,["inputTokenLimit"],c);const d=s(t,["outputTokenLimit"]);d!=null&&o(e,["outputTokenLimit"],d);const f=s(t,["supportedGenerationMethods"]);return f!=null&&o(e,["supportedActions"],f),e}function Ni(i,t){const e={},n=s(t,["totalTokens"]);n!=null&&o(e,["totalTokens"],n);const r=s(t,["cachedContentTokenCount"]);return r!=null&&o(e,["cachedContentTokenCount"],r),e}function Fi(i,t){const e={},n=s(t,["video","uri"]);n!=null&&o(e,["uri"],n);const r=s(t,["video","encodedVideo"]);r!=null&&o(e,["videoBytes"],k(i,r));const l=s(t,["encoding"]);return l!=null&&o(e,["mimeType"],l),e}function ki(i,t){const e={},n=s(t,["_self"]);return n!=null&&o(e,["video"],Fi(i,n)),e}function Vi(i,t){const e={},n=s(t,["generatedSamples"]);n!=null&&(Array.isArray(n)?o(e,["generatedVideos"],n.map(a=>ki(i,a))):o(e,["generatedVideos"],n));const r=s(t,["raiMediaFilteredCount"]);r!=null&&o(e,["raiMediaFilteredCount"],r);const l=s(t,["raiMediaFilteredReasons"]);return l!=null&&o(e,["raiMediaFilteredReasons"],l),e}function Ui(i,t){const e={},n=s(t,["name"]);n!=null&&o(e,["name"],n);const r=s(t,["metadata"]);r!=null&&o(e,["metadata"],r);const l=s(t,["done"]);l!=null&&o(e,["done"],l);const a=s(t,["error"]);a!=null&&o(e,["error"],a);const u=s(t,["response","generateVideoResponse"]);return u!=null&&o(e,["response"],Vi(i,u)),e}function Li(i,t){const e={},n=s(t,["videoMetadata"]);n!=null&&o(e,["videoMetadata"],n);const r=s(t,["thought"]);r!=null&&o(e,["thought"],r);const l=s(t,["codeExecutionResult"]);l!=null&&o(e,["codeExecutionResult"],l);const a=s(t,["executableCode"]);a!=null&&o(e,["executableCode"],a);const u=s(t,["fileData"]);u!=null&&o(e,["fileData"],u);const c=s(t,["functionCall"]);c!=null&&o(e,["functionCall"],c);const d=s(t,["functionResponse"]);d!=null&&o(e,["functionResponse"],d);const f=s(t,["inlineData"]);f!=null&&o(e,["inlineData"],f);const m=s(t,["text"]);return m!=null&&o(e,["text"],m),e}function Gi(i,t){const e={},n=s(t,["parts"]);n!=null&&(Array.isArray(n)?o(e,["parts"],n.map(l=>Li(i,l))):o(e,["parts"],n));const r=s(t,["role"]);return r!=null&&o(e,["role"],r),e}function qi(i,t){const e={},n=s(t,["citations"]);return n!=null&&o(e,["citations"],n),e}function $i(i,t){const e={},n=s(t,["content"]);n!=null&&o(e,["content"],Gi(i,n));const r=s(t,["citationMetadata"]);r!=null&&o(e,["citationMetadata"],qi(i,r));const l=s(t,["finishMessage"]);l!=null&&o(e,["finishMessage"],l);const a=s(t,["finishReason"]);a!=null&&o(e,["finishReason"],a);const u=s(t,["avgLogprobs"]);u!=null&&o(e,["avgLogprobs"],u);const c=s(t,["groundingMetadata"]);c!=null&&o(e,["groundingMetadata"],c);const d=s(t,["index"]);d!=null&&o(e,["index"],d);const f=s(t,["logprobsResult"]);f!=null&&o(e,["logprobsResult"],f);const m=s(t,["safetyRatings"]);return m!=null&&o(e,["safetyRatings"],m),e}function je(i,t){const e={},n=s(t,["candidates"]);n!=null&&(Array.isArray(n)?o(e,["candidates"],n.map(d=>$i(i,d))):o(e,["candidates"],n));const r=s(t,["createTime"]);r!=null&&o(e,["createTime"],r);const l=s(t,["responseId"]);l!=null&&o(e,["responseId"],l);const a=s(t,["modelVersion"]);a!=null&&o(e,["modelVersion"],a);const u=s(t,["promptFeedback"]);u!=null&&o(e,["promptFeedback"],u);const c=s(t,["usageMetadata"]);return c!=null&&o(e,["usageMetadata"],c),e}function Bi(i,t){const e={},n=s(t,["truncated"]);n!=null&&o(e,["truncated"],n);const r=s(t,["token_count"]);return r!=null&&o(e,["tokenCount"],r),e}function Hi(i,t){const e={},n=s(t,["values"]);n!=null&&o(e,["values"],n);const r=s(t,["statistics"]);return r!=null&&o(e,["statistics"],Bi(i,r)),e}function Wi(i,t){const e={},n=s(t,["billableCharacterCount"]);return n!=null&&o(e,["billableCharacterCount"],n),e}function Yi(i,t){const e={},n=s(t,["predictions[]","embeddings"]);n!=null&&(Array.isArray(n)?o(e,["embeddings"],n.map(l=>Hi(i,l))):o(e,["embeddings"],n));const r=s(t,["metadata"]);return r!=null&&o(e,["metadata"],Wi(i,r)),e}function Ki(i,t){const e={},n=s(t,["gcsUri"]);n!=null&&o(e,["gcsUri"],n);const r=s(t,["bytesBase64Encoded"]);r!=null&&o(e,["imageBytes"],k(i,r));const l=s(t,["mimeType"]);return l!=null&&o(e,["mimeType"],l),e}function gt(i,t){const e={},n=s(t,["safetyAttributes","categories"]);n!=null&&o(e,["categories"],n);const r=s(t,["safetyAttributes","scores"]);r!=null&&o(e,["scores"],r);const l=s(t,["contentType"]);return l!=null&&o(e,["contentType"],l),e}function Ji(i,t){const e={},n=s(t,["_self"]);n!=null&&o(e,["image"],Ki(i,n));const r=s(t,["raiFilteredReason"]);r!=null&&o(e,["raiFilteredReason"],r);const l=s(t,["_self"]);l!=null&&o(e,["safetyAttributes"],gt(i,l));const a=s(t,["prompt"]);return a!=null&&o(e,["enhancedPrompt"],a),e}function zi(i,t){const e={},n=s(t,["predictions"]);n!=null&&(Array.isArray(n)?o(e,["generatedImages"],n.map(l=>Ji(i,l))):o(e,["generatedImages"],n));const r=s(t,["positivePromptSafetyAttributes"]);return r!=null&&o(e,["positivePromptSafetyAttributes"],gt(i,r)),e}function Xi(i,t){const e={},n=s(t,["endpoint"]);n!=null&&o(e,["name"],n);const r=s(t,["deployedModelId"]);return r!=null&&o(e,["deployedModelId"],r),e}function Qi(i,t){const e={},n=s(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&o(e,["baseModel"],n);const r=s(t,["createTime"]);r!=null&&o(e,["createTime"],r);const l=s(t,["updateTime"]);return l!=null&&o(e,["updateTime"],l),e}function Oi(i,t){const e={},n=s(t,["name"]);n!=null&&o(e,["name"],n);const r=s(t,["displayName"]);r!=null&&o(e,["displayName"],r);const l=s(t,["description"]);l!=null&&o(e,["description"],l);const a=s(t,["versionId"]);a!=null&&o(e,["version"],a);const u=s(t,["deployedModels"]);u!=null&&(Array.isArray(u)?o(e,["endpoints"],u.map(f=>Xi(i,f))):o(e,["endpoints"],u));const c=s(t,["labels"]);c!=null&&o(e,["labels"],c);const d=s(t,["_self"]);return d!=null&&o(e,["tunedModelInfo"],Qi(i,d)),e}function Zi(i,t){const e={},n=s(t,["totalTokens"]);return n!=null&&o(e,["totalTokens"],n),e}function bi(i,t){const e={},n=s(t,["tokensInfo"]);return n!=null&&o(e,["tokensInfo"],n),e}function ji(i,t){const e={},n=s(t,["gcsUri"]);n!=null&&o(e,["uri"],n);const r=s(t,["bytesBase64Encoded"]);r!=null&&o(e,["videoBytes"],k(i,r));const l=s(t,["mimeType"]);return l!=null&&o(e,["mimeType"],l),e}function es(i,t){const e={},n=s(t,["_self"]);return n!=null&&o(e,["video"],ji(i,n)),e}function ts(i,t){const e={},n=s(t,["videos"]);n!=null&&(Array.isArray(n)?o(e,["generatedVideos"],n.map(a=>es(i,a))):o(e,["generatedVideos"],n));const r=s(t,["raiMediaFilteredCount"]);r!=null&&o(e,["raiMediaFilteredCount"],r);const l=s(t,["raiMediaFilteredReasons"]);return l!=null&&o(e,["raiMediaFilteredReasons"],l),e}function ns(i,t){const e={},n=s(t,["name"]);n!=null&&o(e,["name"],n);const r=s(t,["metadata"]);r!=null&&o(e,["metadata"],r);const l=s(t,["done"]);l!=null&&o(e,["done"],l);const a=s(t,["error"]);a!=null&&o(e,["error"],a);const u=s(t,["response"]);return u!=null&&o(e,["response"],ts(i,u)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const os="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function is(i,t,e){let n,r;e.data instanceof Blob?r=JSON.parse(await e.data.text()):r=JSON.parse(e.data),i.isVertexAI()?n=_o(i,r):n=Eo(i,r),t(n)}class ss{constructor(t,e,n){this.apiClient=t,this.auth=e,this.webSocketFactory=n}async connect(t){var e,n,r,l;const a=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let c;const d=us(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())c=`${a}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(d);else{const _=this.apiClient.getApiKey();c=`${a}/ws/google.ai.generativelanguage.${u}.GenerativeService.BidiGenerateContent?key=${_}`}let f=()=>{};const m=new Promise(_=>{f=_}),p=t.callbacks,g=function(){var _;(_=p==null?void 0:p.onopen)===null||_===void 0||_.call(p),f({})},h=this.apiClient,C={onopen:g,onmessage:_=>{is(h,p.onmessage,_)},onerror:(e=p==null?void 0:p.onerror)!==null&&e!==void 0?e:function(_){},onclose:(n=p==null?void 0:p.onclose)!==null&&n!==void 0?n:function(_){}},y=this.webSocketFactory.create(c,as(d),C);y.connect(),await m;let T=w(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&T.startsWith("publishers/")){const _=this.apiClient.getProject(),A=this.apiClient.getLocation();T=`projects/${_}/locations/${A}/`+T}let v={};this.apiClient.isVertexAI()&&((r=t.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[K.AUDIO]}:t.config.responseModalities=[K.AUDIO]),!((l=t.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const I={model:T,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?v=eo(this.apiClient,I):v=jn(this.apiClient,I),delete v.config,y.send(JSON.stringify(v)),new ls(y,this.apiClient)}}const rs={turnComplete:!0};class ls{constructor(t,e){this.conn=t,this.apiClient=e}tLiveClientContent(t,e){if(e.turns!==null&&e.turns!==void 0){let n=[];try{n=S(t,e.turns),t.isVertexAI()?n=n.map(r=>U(t,r)):n=n.map(r=>Q(t,r))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof e.turns}'`)}return{clientContent:{turns:n,turnComplete:e.turnComplete}}}return{clientContent:{turnComplete:e.turnComplete}}}tLiveClientRealtimeInput(t,e){let n={};if(!("media"in e)||!e.media)throw new Error(`Failed to convert realtime input "media", type: '${typeof e.media}'`);return n={realtimeInput:{mediaChunks:[e.media],activityStart:e.activityStart,activityEnd:e.activityEnd}},n}tLiveClienttToolResponse(t,e){let n=[];if(e.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(e.functionResponses)?n=e.functionResponses:n=[e.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const l of n){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!t.isVertexAI()&&!("id"in l))throw new Error(os)}return{toolResponse:{functionResponses:n}}}sendClientContent(t){t=Object.assign(Object.assign({},rs),t);const e=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(e))}sendRealtimeInput(t){if(t.media==null)throw new Error("Media is required.");const e=this.tLiveClientRealtimeInput(this.apiClient,t);this.conn.send(JSON.stringify(e))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const e=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(e))}close(){this.conn.close()}}function as(i){const t={};return i.forEach((e,n)=>{t[n]=e}),t}function us(i){const t=new Headers;for(const[e,n]of Object.entries(i))t.append(e,n);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cs extends z{constructor(t){super(),this.apiClient=t,this.generateContent=async e=>await this.generateContentInternal(e),this.generateContentStream=async e=>await this.generateContentStreamInternal(e),this.generateImages=async e=>await this.generateImagesInternal(e).then(n=>{var r;let l;const a=[];if(n!=null&&n.generatedImages)for(const c of n.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((r=c==null?void 0:c.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?l=c==null?void 0:c.safetyAttributes:a.push(c);let u;return l?u={generatedImages:a,positivePromptSafetyAttributes:l}:u={generatedImages:a},u})}async generateContentInternal(t){var e,n;let r,l="",a={};if(this.apiClient.isVertexAI()){const u=Ze(this.apiClient,t);return l=E("{model}:generateContent",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),r.then(c=>{const d=je(this.apiClient,c),f=new G;return Object.assign(f,d),f})}else{const u=Oe(this.apiClient,t);return l=E("{model}:generateContent",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),r.then(c=>{const d=be(this.apiClient,c),f=new G;return Object.assign(f,d),f})}}async generateContentStreamInternal(t){var e,n;let r,l="",a={};if(this.apiClient.isVertexAI()){const u=Ze(this.apiClient,t);l=E("{model}:streamGenerateContent?alt=sse",u._url),a=u._query,delete u.config,delete u._url,delete u._query;const c=this.apiClient;return r=c.requestStream({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}),r.then(function(d){return J(this,arguments,function*(){var f,m,p,g;try{for(var h=!0,C=j(d),y;y=yield M(C.next()),f=y.done,!f;h=!0){g=y.value,h=!1;const v=je(c,yield M(g.json())),I=new G;Object.assign(I,v),yield yield M(I)}}catch(T){m={error:T}}finally{try{!h&&!f&&(p=C.return)&&(yield M(p.call(C)))}finally{if(m)throw m.error}}})})}else{const u=Oe(this.apiClient,t);l=E("{model}:streamGenerateContent?alt=sse",u._url),a=u._query,delete u.config,delete u._url,delete u._query;const c=this.apiClient;return r=c.requestStream({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}),r.then(function(d){return J(this,arguments,function*(){var f,m,p,g;try{for(var h=!0,C=j(d),y;y=yield M(C.next()),f=y.done,!f;h=!0){g=y.value,h=!1;const v=be(c,yield M(g.json())),I=new G;Object.assign(I,v),yield yield M(I)}}catch(T){m={error:T}}finally{try{!h&&!f&&(p=C.return)&&(yield M(p.call(C)))}finally{if(m)throw m.error}}})})}}async embedContent(t){var e,n;let r,l="",a={};if(this.apiClient.isVertexAI()){const u=ci(this.apiClient,t);return l=E("{model}:predict",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),r.then(c=>{const d=Yi(this.apiClient,c),f=new Be;return Object.assign(f,d),f})}else{const u=$o(this.apiClient,t);return l=E("{model}:batchEmbedContents",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),r.then(c=>{const d=wi(this.apiClient,c),f=new Be;return Object.assign(f,d),f})}}async generateImagesInternal(t){var e,n;let r,l="",a={};if(this.apiClient.isVertexAI()){const u=fi(this.apiClient,t);return l=E("{model}:predict",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),r.then(c=>{const d=zi(this.apiClient,c),f=new He;return Object.assign(f,d),f})}else{const u=Ho(this.apiClient,t);return l=E("{model}:predict",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),r.then(c=>{const d=Ri(this.apiClient,c),f=new He;return Object.assign(f,d),f})}}async get(t){var e,n;let r,l="",a={};if(this.apiClient.isVertexAI()){const u=pi(this.apiClient,t);return l=E("{name}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),r.then(c=>Oi(this.apiClient,c))}else{const u=Wo(this.apiClient,t);return l=E("{name}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),r.then(c=>Di(this.apiClient,c))}}async countTokens(t){var e,n;let r,l="",a={};if(this.apiClient.isVertexAI()){const u=hi(this.apiClient,t);return l=E("{model}:countTokens",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),r.then(c=>{const d=Zi(this.apiClient,c),f=new We;return Object.assign(f,d),f})}else{const u=Ko(this.apiClient,t);return l=E("{model}:countTokens",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),r.then(c=>{const d=Ni(this.apiClient,c),f=new We;return Object.assign(f,d),f})}}async computeTokens(t){var e;let n,r="",l={};if(this.apiClient.isVertexAI()){const a=gi(this.apiClient,t);return r=E("{model}:computeTokens",a._url),l=a._query,delete a.config,delete a._url,delete a._query,n=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(u=>u.json()),n.then(u=>{const c=bi(this.apiClient,u),d=new nn;return Object.assign(d,c),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(t){var e,n;let r,l="",a={};if(this.apiClient.isVertexAI()){const u=Ti(this.apiClient,t);return l=E("{model}:predictLongRunning",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),r.then(c=>ns(this.apiClient,c))}else{const u=Xo(this.apiClient,t);return l=E("{model}:predictLongRunning",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),r.then(c=>Ui(this.apiClient,c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ds(i,t){const e={},n=s(t,["operationName"]);n!=null&&o(e,["_url","operationName"],n);const r=s(t,["config"]);return r!=null&&o(e,["config"],r),e}function fs(i,t){const e={},n=s(t,["operationName"]);n!=null&&o(e,["_url","operationName"],n);const r=s(t,["config"]);return r!=null&&o(e,["config"],r),e}function ps(i,t){const e={},n=s(t,["operationName"]);n!=null&&o(e,["operationName"],n);const r=s(t,["resourceName"]);r!=null&&o(e,["_url","resourceName"],r);const l=s(t,["config"]);return l!=null&&o(e,["config"],l),e}function ms(i,t){const e={},n=s(t,["video","uri"]);n!=null&&o(e,["uri"],n);const r=s(t,["video","encodedVideo"]);r!=null&&o(e,["videoBytes"],k(i,r));const l=s(t,["encoding"]);return l!=null&&o(e,["mimeType"],l),e}function hs(i,t){const e={},n=s(t,["_self"]);return n!=null&&o(e,["video"],ms(i,n)),e}function gs(i,t){const e={},n=s(t,["generatedSamples"]);n!=null&&(Array.isArray(n)?o(e,["generatedVideos"],n.map(a=>hs(i,a))):o(e,["generatedVideos"],n));const r=s(t,["raiMediaFilteredCount"]);r!=null&&o(e,["raiMediaFilteredCount"],r);const l=s(t,["raiMediaFilteredReasons"]);return l!=null&&o(e,["raiMediaFilteredReasons"],l),e}function ys(i,t){const e={},n=s(t,["name"]);n!=null&&o(e,["name"],n);const r=s(t,["metadata"]);r!=null&&o(e,["metadata"],r);const l=s(t,["done"]);l!=null&&o(e,["done"],l);const a=s(t,["error"]);a!=null&&o(e,["error"],a);const u=s(t,["response","generateVideoResponse"]);return u!=null&&o(e,["response"],gs(i,u)),e}function Cs(i,t){const e={},n=s(t,["gcsUri"]);n!=null&&o(e,["uri"],n);const r=s(t,["bytesBase64Encoded"]);r!=null&&o(e,["videoBytes"],k(i,r));const l=s(t,["mimeType"]);return l!=null&&o(e,["mimeType"],l),e}function Ts(i,t){const e={},n=s(t,["_self"]);return n!=null&&o(e,["video"],Cs(i,n)),e}function vs(i,t){const e={},n=s(t,["videos"]);n!=null&&(Array.isArray(n)?o(e,["generatedVideos"],n.map(a=>Ts(i,a))):o(e,["generatedVideos"],n));const r=s(t,["raiMediaFilteredCount"]);r!=null&&o(e,["raiMediaFilteredCount"],r);const l=s(t,["raiMediaFilteredReasons"]);return l!=null&&o(e,["raiMediaFilteredReasons"],l),e}function et(i,t){const e={},n=s(t,["name"]);n!=null&&o(e,["name"],n);const r=s(t,["metadata"]);r!=null&&o(e,["metadata"],r);const l=s(t,["done"]);l!=null&&o(e,["done"],l);const a=s(t,["error"]);a!=null&&o(e,["error"],a);const u=s(t,["response"]);return u!=null&&o(e,["response"],vs(i,u)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Is extends z{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const e=t.operation,n=t.config;if(e.name===void 0||e.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=e.name.split("/operations/")[0];let l;return n&&"httpOptions"in n&&(l=n.httpOptions),this.fetchPredictVideosOperationInternal({operationName:e.name,resourceName:r,config:{httpOptions:l}})}else return this.getVideosOperationInternal({operationName:e.name,config:n})}async getVideosOperationInternal(t){var e,n;let r,l="",a={};if(this.apiClient.isVertexAI()){const u=fs(this.apiClient,t);return l=E("{operationName}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(c=>c.json()),r.then(c=>et(this.apiClient,c))}else{const u=ds(this.apiClient,t);return l=E("{operationName}",u._url),a=u._query,delete u.config,delete u._url,delete u._query,r=this.apiClient.request({path:l,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions}).then(c=>c.json()),r.then(c=>ys(this.apiClient,c))}}async fetchPredictVideosOperationInternal(t){var e;let n,r="",l={};if(this.apiClient.isVertexAI()){const a=ps(this.apiClient,t);return r=E("{resourceName}:fetchPredictOperation",a._url),l=a._query,delete a.config,delete a._url,delete a._query,n=this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(e=t.config)===null||e===void 0?void 0:e.httpOptions}).then(u=>u.json()),n.then(u=>et(this.apiClient,u))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Es="Content-Type",_s="X-Server-Timeout",Ss="User-Agent",As="x-goog-api-client",ws="0.9.0",Ms=`google-genai-sdk/${ws}`,Ps="v1beta1",Rs="v1beta",tt=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class xs extends Error{constructor(t,e){e?super(t,{cause:e}):super(t,{cause:new Error().stack}),this.message=t,this.name="ClientError"}}class nt extends Error{constructor(t,e){e?super(t,{cause:e}):super(t,{cause:new Error().stack}),this.message=t,this.name="ServerError"}}class Ds{constructor(t){var e,n;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(e=this.clientOptions.apiVersion)!==null&&e!==void 0?e:Ps,this.getProject()||this.getLocation()?(r.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`,this.clientOptions.apiKey=void 0):(r.baseUrl="https://aiplatform.googleapis.com/",this.clientOptions.project=void 0,this.clientOptions.location=void 0)):(r.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Rs,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,t.httpOptions))}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&n.push(t.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),e=new URL(t);return e.protocol="wss",e.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,e,n){const r=[this.getRequestUrlInternal(e)];return n&&r.push(this.getBaseResourcePath()),t!==""&&r.push(t),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let e=this.clientOptions.httpOptions;t.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t),r=this.constructUrl(t.path,e,n);if(t.queryParams)for(const[a,u]of Object.entries(t.queryParams))r.searchParams.append(a,String(u));let l={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=t.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,e),this.unaryApiCall(r,l,t.httpMethod)}patchHttpOptions(t,e){const n=JSON.parse(JSON.stringify(t));for(const[r,l]of Object.entries(e))typeof l=="object"?n[r]=Object.assign(Object.assign({},n[r]),l):l!==void 0&&(n[r]=l);return n}async requestStream(t){let e=this.clientOptions.httpOptions;t.httpOptions&&(e=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const n=this.shouldPrependVertexProjectPath(t),r=this.constructUrl(t.path,e,n);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let l={};return l.body=t.body,l=await this.includeExtraHttpOptionsToRequestInit(l,e),this.streamApiCall(r,l,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,e){if(e&&e.timeout&&e.timeout>0){const n=new AbortController,r=n.signal;setTimeout(()=>n.abort(),e.timeout),t.signal=r}return t.headers=await this.getHeadersInternal(e),t}async unaryApiCall(t,e,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},e),{method:n})).then(async r=>(await ot(r),new b(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(t,e,n){return this.apiCall(t.toString(),Object.assign(Object.assign({},e),{method:n})).then(async r=>(await ot(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(t){var e;return J(this,arguments,function*(){const r=(e=t==null?void 0:t.body)===null||e===void 0?void 0:e.getReader(),l=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let a="";for(;;){const{done:u,value:c}=yield M(r.read());if(u){if(a.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=l.decode(c);a+=d;let f=a.match(tt);for(;f;){const m=f[1];try{const p=new Response(m,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield M(new b(p)),a=a.slice(f[0].length),f=a.match(tt)}catch(p){throw new Error(`exception parsing stream chunk ${m}. ${p}`)}}}}finally{r.releaseLock()}})}async apiCall(t,e){return fetch(t,e).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const t={},e=Ms+" "+this.clientOptions.userAgentExtra;return t[Ss]=e,t[As]=e,t[Es]="application/json",t}async getHeadersInternal(t){const e=new Headers;if(t&&t.headers){for(const[n,r]of Object.entries(t.headers))e.append(n,r);t.timeout&&t.timeout>0&&e.append(_s,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(e),e}async uploadFile(t,e){var n;const r={};e!=null&&(r.mimeType=e.mimeType,r.name=e.name,r.displayName=e.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const l=this.clientOptions.uploader,a=await l.stat(t);r.sizeBytes=String(a.size);const u=(n=e==null?void 0:e.mimeType)!==null&&n!==void 0?n:a.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=u;const c=await this.fetchUploadUrl(r,e);return l.upload(t,c,this)}async fetchUploadUrl(t,e){var n;let r={};e!=null&&e.httpOptions?r=e.httpOptions:r={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${t.mimeType}`}};const l={file:t},a=await this.request({path:E("upload/v1beta/files",l._url),body:JSON.stringify(l),httpMethod:"POST",httpOptions:r});if(!a||!(a!=null&&a.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(n=a==null?void 0:a.headers)===null||n===void 0?void 0:n["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function ot(i){var t;if(i===void 0)throw new nt("response is undefined");if(!i.ok){const e=i.status,n=i.statusText;let r;!((t=i.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?r=await i.json():r={error:{message:"exception parsing response",code:i.status,status:i.statusText}};const l=`got status: ${e} ${n}. ${JSON.stringify(r)}`;throw e>=400&&e<500?new xs(l):e>=500&&e<600?new nt(l):new Error(l)}}const Ns=1024*1024*8;async function Fs(i,t,e){var n,r;let l=0,a=0,u=new b(new Response),c="upload";for(l=i.size;a<l;){const f=Math.min(Ns,l-a),m=i.slice(a,a+f);if(a+f>=l&&(c+=", finalize"),u=await e.request({path:"",body:m,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(a),"Content-Length":String(f)}}}),a+=f,((n=u==null?void 0:u.headers)===null||n===void 0?void 0:n["x-goog-upload-status"])!=="active")break;if(l<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const d=await(u==null?void 0:u.json());if(((r=u==null?void 0:u.headers)===null||r===void 0?void 0:r["x-goog-upload-status"])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return d.file}async function ks(i){return{size:i.size,type:i.type}}class Vs{async upload(t,e,n){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await Fs(t,e,n)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await ks(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Us{create(t,e,n){return new Ls(t,e,n)}}class Ls{constructor(t,e,n){this.url=t,this.headers=e,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const it="x-goog-api-key";class Gs{constructor(t){this.apiKey=t}async addAuthHeaders(t){t.get(it)===null&&t.append(it,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qs="gl-node/";class $s{constructor(t){var e;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(e=t.vertexai)!==null&&e!==void 0?e:!1,this.apiKey=t.apiKey,this.apiVersion=t.apiVersion;const n=new Gs(this.apiKey);this.apiClient=new Ds({auth:n,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:qs+"web",uploader:new Vs}),this.models=new cs(this.apiClient),this.live=new ss(this.apiClient,n,new Us),this.chats=new dn(this.models,this.apiClient),this.caches=new ln(this.apiClient),this.files=new Sn(this.apiClient),this.operations=new Is(this.apiClient)}}class Bs{constructor(t){this.apiKey=t,this.genAI=null,this.model=null,this._initialized=!1,this.lastApiCallTime=0,this.minTimeBetweenCalls=5e3,this.maxTimeBetweenCalls=6e4,this.retryCount=0,this.maxRetries=3,this.modelId="gemini-2.5-pro-exp-03-25",this.lastSuccessTime=null,this.consecutiveSuccesses=0,this.lastFailureTime=null,this.failureCount=0,this.usageStats={totalRequests:0,totalTokensUsed:0,requestsByModel:{},tokensByModel:{},errors:{count:0,byType:{}}}}getUsageStats(){return{...this.usageStats}}getModelStatus(){const t=Date.now(),e={},n=this.modelId,r=this.lastSuccessTime||0,l=this.lastFailureTime||0,a=this.failureCount||0,u=this.consecutiveSuccesses||0;return e[n]={isCurrentModel:!0,lastSuccessTime:r?new Date(r).toISOString():null,lastFailureTime:l?new Date(l).toISOString():null,timeSinceLastSuccess:r?t-r:null,timeSinceLastFailure:l?t-l:null,failureCount:a,successStreak:u,tokenUsage:this.usageStats.tokensByModel[n]||0,requestCount:this.usageStats.requestsByModel[n]||0},{currentModel:this.modelId,models:e,totalRequests:this.usageStats.totalRequests,totalTokensUsed:this.usageStats.totalTokensUsed,initialized:this._initialized,lastApiCallTime:this.lastApiCallTime?new Date(this.lastApiCallTime).toISOString():null}}_extractJsonFromText(t){try{try{return JSON.parse(t)}catch{console.log("Direct JSON parsing failed, trying to extract from markdown...")}const e=/```(?:json)?\s*([\s\S]*?)```/,n=t.match(e);if(n&&n[1]){const a=n[1].trim();return console.log("Extracted JSON from markdown code block"),JSON.parse(a)}const r=/\{[\s\S]*\}/,l=t.match(r);if(l){const a=l[0].trim();return console.log("Extracted JSON using curly brace detection"),JSON.parse(a)}return console.warn("Could not extract JSON from text. Raw text:",t.substring(0,200)+"..."),null}catch(e){return console.error("Error extracting JSON from text:",e),null}}getSafetySettings(){return this.safetySettings}getSafetyRatings(t){try{return t!=null&&t.safetyRatings?t.safetyRatings.map(e=>({category:e.category,probability:e.probability,blocked:e.blocked||!1})):null}catch(e){return console.warn("Error extracting safety ratings:",e),null}}async _validateApiKey(t="gemini-1.5-flash"){var e;try{if(!this.apiKey||this.apiKey.length<10)return{valid:!1,status:"invalid_format",message:"Invalid API key format. API keys should be at least 10 characters long."};const n=this._getFirebaseFunctionUrl("geminiProxy");console.log(`Validating API key with model: ${t}...`);const r=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:t,prompt:"Hello",config:{maxOutputTokens:10,temperature:.1}})}),l=await r.json();return r.ok?{valid:!0,status:"valid",message:"API key is valid and has access to the model.",modelDetails:l}:r.status===400?{valid:!1,status:"invalid_key",message:"The API key is invalid or malformed."}:r.status===401||r.status===403?{valid:!1,status:"unauthorized",message:"The API key is not authorized to access this model. Please check your API key permissions."}:r.status===404?{valid:!1,status:"model_not_found",message:`The model '${t}' was not found. It may not be available or enabled for your API key.`}:r.status===429?{valid:!1,status:"quota_exceeded",message:"API quota exceeded. Please try again later or use a different API key."}:{valid:!1,status:"api_error",message:`API error: ${((e=l.error)==null?void 0:e.message)||r.statusText}`,details:l.error}}catch(n){return{valid:!1,status:"network_error",message:`Network error: ${n.message}`,error:n}}}_getFirebaseFunctionUrl(t){return`https://us-central1-green-9d6cd.cloudfunctions.net/${t}`}async initialize(){try{const t=await this._validateApiKey(this.modelId);if(!t.valid)return console.warn(`API key validation failed: ${t.message}`),this._initializeFallback(t.message);console.log("API key validation successful:",t.message);try{this.genAI=new $s({apiKey:this.apiKey}),this.safetySettings={harassment:"block_medium_and_above",hateSpeech:"block_medium_and_above",sexuallyExplicit:"block_medium_and_above",dangerousContent:"block_medium_and_above"},console.log(`GeminiService: Using ${this.modelId} for initialization`),console.log(`Testing API key with minimal prompt using model: ${this.modelId}...`);const e={maxOutputTokens:10,temperature:.1},n=await this.genAI.models.generateContent({model:this.modelId,contents:[$e("Test")],config:e});return this._initialized=!0,console.log("Gemini AI initialized successfully"),!0}catch(e){let n="Failed to initialize Gemini API";return e.message&&e.message.includes("API key expired")?n="API key expired. Please renew your API key in settings.":e.message&&e.message.includes("INVALID_ARGUMENT")?n="Invalid API key. Please check your API key in settings.":e.message&&e.message.includes("429")&&(n="API quota exceeded. Using fallback mode temporarily."),console.error(`Failed to initialize Gemini API client: ${n}`,e),this._initializeFallback(n)}}catch(t){return console.error("Failed to initialize Gemini service:",t),this._initializeFallback("Gemini service initialization failed")}}_checkAndResetModel(){const e=Date.now()-(this.lastFailureTime||0),n=60*60*1e3;e>n&&(console.log("It's been over an hour since the last failure. Resetting retry count."),this.retryCount=0)}async _callApiWithRateLimit(t){var r;this._checkAndResetModel();const n=Date.now()-this.lastApiCallTime;if(n<this.minTimeBetweenCalls){const l=.8+Math.random()*.4,a=Math.floor((this.minTimeBetweenCalls-n)*l);console.log(`Rate limiting: waiting ${a}ms before next API call`),await new Promise(u=>setTimeout(u,a))}try{this.lastApiCallTime=Date.now(),console.log(`Using Gemini model: ${this.modelId}`);const{contents:l,config:a}=t,u=a?{temperature:a.temperature,topK:a.topK,topP:a.topP,maxOutputTokens:a.maxOutputTokens,stopSequences:a.stopSequences}:void 0;this.usageStats.totalRequests++,this.usageStats.requestsByModel[this.modelId]||(this.usageStats.requestsByModel[this.modelId]=0),this.usageStats.requestsByModel[this.modelId]++,console.log("GeminiService: Calling Gemini API with model:",this.modelId),console.log("GeminiService: Request payload:",{model:this.modelId,contents:typeof l=="string"?l.substring(0,100)+"...":"complex content",config:u});const c=await this.genAI.models.generateContent({model:this.modelId,contents:[$e(l)],config:u});if(c.candidates&&c.candidates[0]&&c.candidates[0].content&&c.candidates[0].content.parts&&c.candidates[0].content.parts[0]&&c.candidates[0].content.parts[0].text===""&&(console.warn("Received empty response from Gemini API with finish reason:",c.candidates[0].finishReason),c.candidates[0].finishReason==="MAX_TOKENS"&&a&&a.maxOutputTokens<2048)){console.log("Retrying with higher token limit...");const d={...a,maxOutputTokens:Math.min(a.maxOutputTokens*2,2048)};return this._callApiWithRateLimit({contents:l,config:d})}try{if((r=c.promptFeedback)!=null&&r.tokenCount){const d=c.promptFeedback.tokenCount;this.usageStats.totalTokensUsed+=d,this.usageStats.tokensByModel[this.modelId]||(this.usageStats.tokensByModel[this.modelId]=0),this.usageStats.tokensByModel[this.modelId]+=d,console.log(`Used ${d} tokens with model ${this.modelId}`)}this.consecutiveSuccesses[this.modelId]||(this.consecutiveSuccesses[this.modelId]=0),this.consecutiveSuccesses[this.modelId]++,this.lastSuccessTime[this.modelId]=Date.now(),this.consecutiveSuccesses[this.modelId]>=5&&console.log(`${this.modelId} has had ${this.consecutiveSuccesses[this.modelId]} consecutive successes.`)}catch(d){console.warn("Could not track token usage or success:",d)}return c.text||(c.candidates&&c.candidates[0]&&c.candidates[0].content&&c.candidates[0].content.parts&&c.candidates[0].content.parts[0]?(c.text=c.candidates[0].content.parts[0].text,console.log("Added text property to response from candidates:",c.text.substring(0,50)+"...")):(console.warn("Could not extract text from response:",c),c.text="I apologize, but I encountered an issue processing your request. Please try again.")),c}catch(l){this.usageStats.errors.count++;let a="unknown";if(l.message&&(l.message.includes("429")||l.message.includes("RESOURCE_EXHAUSTED")||l.message.includes("quota")?a="quota_exceeded":l.message.includes("404")?a="model_not_found":l.message.includes("400")?a="bad_request":l.message.includes("401")||l.message.includes("403")?a="unauthorized":l.message.includes("500")?a="server_error":l.message.includes("timeout")?a="timeout":l.message.includes("network")&&(a="network")),this.usageStats.errors.byType[a]||(this.usageStats.errors.byType[a]=0),this.usageStats.errors.byType[a]++,a==="quota_exceeded"){if(console.warn("API quota exceeded for model:",this.modelId),this.modelFailures[this.modelId]||(this.modelFailures[this.modelId]=0),this.modelFailures[this.modelId]++,this._lastFailureTime=Date.now(),console.warn(`Quota error details for ${this.modelId}:`,{failureCount:this.modelFailures[this.modelId],errorMessage:l.message,timestamp:new Date().toISOString()}),this.modelFailures[this.modelId]===1){const p=2e3+Math.random()*1e3;return console.log(`First quota error for ${this.modelId}. Short backoff for ${p}ms before retrying...`),await new Promise(g=>setTimeout(g,p)),this.modelFailures[this.modelId]=0,this._callApiWithRateLimit(t)}if(console.warn("Rate limit reached for Gemini 2.0 Flash. Using exponential backoff..."),console.warn("All models have been tried. Using exponential backoff..."),this.retryCount++,this.retryCount>this.maxRetries)throw this.retryCount=0,new Error("Maximum retry attempts exceeded due to rate limiting on all models");const c=this.minTimeBetweenCalls,d=c*Math.pow(2,this.retryCount),f=.8+Math.random()*.4,m=Math.min(Math.floor(d*f),this.maxTimeBetweenCalls);return this.minTimeBetweenCalls=Math.min(c*2,this.maxTimeBetweenCalls/2),console.log(`Retry ${this.retryCount}/${this.maxRetries}: waiting ${m}ms before retrying`),await new Promise(p=>setTimeout(p,m)),this._callApiWithRateLimit(t)}throw l.message&&l.message.includes("404")?(console.error(`Model ${this.modelId} not found (404 error)`),new Error(`Model ${this.modelId} not found. Please check if the model is available.`)):l.message&&l.message.includes("400")&&(l.message.includes("API key expired")||l.message.includes("INVALID_ARGUMENT"))?(console.error("Gemini API key has expired. Please renew your API key in settings."),new Error("API key expired. Please renew your API key in the settings.")):l}}async generatePrompt(t){try{return(await this._callApiWithRateLimit({contents:t})).text||""}catch(e){throw console.error("Error generating prompt:",e),e}}_initializeFallback(t="API unavailable"){return console.warn(`Using fallback simulation instead of Gemini API: ${t}`),this._initialized=!1,this.fallbackReason=t,this._lastFailureTime=Date.now(),this.retryCount=0,!1}canRetryAfterFailure(){if(!this._lastFailureTime)return!0;const t=5*60*1e3;return Date.now()-this._lastFailureTime>t}isInitialized(){return this._initialized}getFallbackReason(){return this._initialized?null:this.fallbackReason||"API unavailable"}getCurrentModel(){return this.modelId}async getCurrentWeather(){var t,e,n,r;try{const l=Date.now(),a=localStorage.getItem("weatherData"),u=localStorage.getItem("weatherTimestamp");if(a&&u&&l-parseInt(u,10)<30*60*1e3)return console.log("Using cached weather data from localStorage"),{data:JSON.parse(a),safetyRatings:null};console.log("Fetching fresh weather data from WeatherAPI.com");try{const f=`https://api.weatherapi.com/v1/forecast.json?key=38803ec999864a7199f82503251804&q=${encodeURIComponent("Winston,Oregon,United States")}&days=3&aqi=yes&alerts=yes`,m=await fetch(f);if(!m.ok)throw new Error(`Weather API error: ${m.status} ${m.statusText}`);const p=await m.json();console.log("WeatherAPI.com raw response:",{current:p.current,location:p.location,forecast_days:p.forecast.forecastday.length,alerts:((e=(t=p.alerts)==null?void 0:t.alert)==null?void 0:e.length)||0}),console.log("Current weather details:",{temp_f:p.current.temp_f,condition:p.current.condition.text,wind_mph:p.current.wind_mph,wind_dir:p.current.wind_dir,humidity:p.current.humidity,precip_in:p.current.precip_in,feelslike_f:p.current.feelslike_f,uv:p.current.uv});const g={temperature:{current:Math.round(p.current.temp_f),feelsLike:Math.round(p.current.feelslike_f),high:Math.round(p.forecast.forecastday[0].day.maxtemp_f),low:Math.round(p.forecast.forecastday[0].day.mintemp_f),avgHigh:Math.round(p.forecast.forecastday[0].day.maxtemp_f),avgLow:Math.round(p.forecast.forecastday[0].day.mintemp_f)},conditions:p.current.condition.text,wind:{speed:p.current.wind_mph,direction:p.current.wind_dir,gust:p.current.gust_mph},humidity:p.current.humidity,uv:p.current.uv,precipitation:{chance:p.forecast.forecastday[0].day.daily_chance_of_rain,amount:p.current.precip_in,forecast:p.forecast.forecastday[0].day.totalprecip_in,unit:"inches"},forecast:[...p.forecast.forecastday.map((h,C)=>{const y=new Date(h.date),T=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][y.getDay()];return{day:C+1,date:h.date,dayName:T,high:Math.round(h.day.maxtemp_f),low:Math.round(h.day.mintemp_f),condition:h.day.condition.text,icon:h.day.condition.icon,precipChance:h.day.daily_chance_of_rain,precipAmount:h.day.totalprecip_in,humidity:h.day.avghumidity,wind:h.day.maxwind_mph}})],alerts:((r=(n=p.alerts)==null?void 0:n.alert)==null?void 0:r.map(h=>({headline:h.headline,severity:h.severity,urgency:h.urgency,areas:h.areas,category:h.category,event:h.event,effective:h.effective,expires:h.expires,desc:h.desc})))||[],airQuality:p.current.air_quality?{co:p.current.air_quality.co,no2:p.current.air_quality.no2,o3:p.current.air_quality.o3,pm2_5:p.current.air_quality.pm2_5,pm10:p.current.air_quality.pm10,usEpaIndex:p.current.air_quality["us-epa-index"],gbDefraIndex:p.current.air_quality["gb-defra-index"]}:null,recentTrends:`${p.current.condition.text} conditions with temperatures ranging from ${Math.round(p.forecast.forecastday[0].day.mintemp_f)}F to ${Math.round(p.forecast.forecastday[0].day.maxtemp_f)}F.`,location:{name:p.location.name,region:p.location.region,country:p.location.country,lat:p.location.lat,lon:p.location.lon,localtime:p.location.localtime,tzId:p.location.tz_id},fetchedAt:new Date().toISOString(),source:"WeatherAPI.com",raw:p};return localStorage.setItem("weatherData",JSON.stringify(g)),localStorage.setItem("weatherTimestamp",l.toString()),console.log("Weather data successfully fetched and cached"),{data:g,safetyRatings:null}}catch(c){console.warn("Error fetching from weather API:",c);const d=localStorage.getItem("weatherData");if(d)return console.log("Using cached weather data as fallback after API error"),{data:JSON.parse(d),safetyRatings:null};throw new Error(`Weather API error: ${c.message}. Please check your internet connection or try again later.`)}}catch(l){throw console.error("Error in weather data processing:",l),l}}clearWeatherCache(){const t=localStorage.getItem("weatherData")!==null;return localStorage.removeItem("weatherData"),localStorage.removeItem("weatherTimestamp"),console.log("Weather data cache cleared"),t}_generateHistoricalWeatherData(){const t=new Date().getMonth();return{data:{temperature:this._getSeasonalTemperature(t),conditions:this._getSeasonalConditions(t),precipitation:this._getRandomPrecipitation(t),forecast:this._getRandomForecast(t),recentTrends:this._getRandomTrends(t),fetchedAt:new Date().toISOString(),source:"Historical averages (emergency fallback)"},safetyRatings:null}}_getSeasonalTemperature(t){const n=[{low:34,high:51},{low:36,high:55},{low:39,high:60},{low:42,high:65},{low:47,high:72},{low:52,high:79},{low:55,high:88},{low:55,high:88},{low:50,high:82},{low:44,high:70},{low:39,high:57},{low:35,high:50}][t],r=Math.floor(n.low+(n.high-n.low)*.6);return{high:n.high,low:n.low,current:r}}_getSeasonalConditions(t){const e=[["Cloudy","Rainy","Partly Cloudy","Overcast"],["Partly Cloudy","Sunny","Light Rain","Clear"],["Sunny","Clear","Hot","Dry"],["Partly Cloudy","Foggy Morning","Sunny","Clear"]];let n;t>=2&&t<=4?n=1:t>=5&&t<=7?n=2:t>=8&&t<=10?n=3:n=0;const r=e[n];return r[Math.floor(Math.random()*r.length)]}_getRandomPrecipitation(t){const n=[70,65,60,50,35,20,5,5,15,40,65,70][t],r=t>=11||t<=1?"Snow/Rain":"Rain";return{chance:n,type:r,amount:n>50?"Moderate":"Light"}}_getRandomForecast(t){const e=[],n=this._getSeasonalTemperature(t);for(let r=0;r<3;r++){const l=Math.floor(Math.random()*7)-3;e.push({day:r+1,high:n.high+l,low:n.low+l,conditions:this._getSeasonalConditions(t)})}return e}_getRandomTrends(t){const e=[{temp:"Below normal",precip:"Above normal"},{temp:"Near normal",precip:"Near normal"},{temp:"Above normal",precip:"Below normal"},{temp:"Near normal",precip:"Near normal"}];let n;return t>=2&&t<=4?n=1:t>=5&&t<=7?n=2:t>=8&&t<=10?n=3:n=0,e[n]}async getGardeningRecommendations(t){try{console.log("Generating gardening recommendations based on weather data");const e=new Date().getMonth();return{data:{urgent:this._getUrgentRecommendations(t),watering:this._getWateringRecommendations(t),planting:this._getPlantingRecommendations(e,t),maintenance:this._getMaintenanceRecommendations(e,t),weatherAlert:this._getWeatherAlerts(t),generatedAt:new Date().toISOString(),source:"Rule-based recommendations"},safetyRatings:null}}catch(e){throw console.error("Error generating recommendations:",e),e}}_getUrgentRecommendations(t){const e=new Date().getMonth(),n=["Winter","Winter","Spring","Spring","Spring","Summer","Summer","Summer","Fall","Fall","Fall","Winter"][e],r=[`Check plants for signs of ${n==="Summer"?"heat stress":n==="Winter"?"frost damage":"seasonal pests"}.`,`${n==="Spring"?"Watch for late frost warnings.":n==="Fall"?"Prepare for first frost.":n==="Summer"?"Ensure adequate watering during hot periods.":"Protect sensitive plants from freezing temperatures."}`];return t.temperature.high>90?r.push("Extreme heat alert: Provide extra shade and water for sensitive plants."):t.temperature.low<32&&r.push("Frost alert: Cover sensitive plants tonight."),t.precipitation.chance>70&&r.push("High chance of precipitation: Check drainage in garden beds."),r}_getWateringRecommendations(t){const e=new Date().getMonth(),n=["Winter","Winter","Spring","Spring","Spring","Summer","Summer","Summer","Fall","Fall","Fall","Winter"][e];return[`${n==="Summer"?"Water deeply in the early morning to reduce evaporation.":n==="Winter"?"Reduce watering for dormant plants.":"Adjust watering based on rainfall and temperature."}`,`${t.precipitation.chance>30?"Expected rainfall may reduce watering needs this week.":"Supplemental watering may be needed based on current conditions."}`]}_getPlantingRecommendations(t,e){const n=["Winter","Winter","Spring","Spring","Spring","Summer","Summer","Summer","Fall","Fall","Fall","Winter"][t];return[`${n==="Spring"?"Good time for cool-season crops and starting warm-season seeds.":n==="Summer"?"Plant fall crops like broccoli and kale.":n==="Fall"?"Plant garlic, onions, and cover crops.":"Plan next year's garden and order seeds."}`]}_getMaintenanceRecommendations(t,e){const n=["Winter","Winter","Spring","Spring","Spring","Summer","Summer","Summer","Fall","Fall","Fall","Winter"][t];return[`${n==="Spring"?"Prepare beds with compost and complete pruning.":n==="Summer"?"Apply organic mulch to conserve moisture.":n==="Fall"?"Collect leaves for compost and mulch.":"Service tools and equipment for the upcoming season."}`,`Current temperature range (${e.temperature.low}F to ${e.temperature.high}F) is ${e.temperature.high>85?"high":e.temperature.low<32?"low":"moderate"} - ${e.temperature.high>85?"provide shade for sensitive plants":e.temperature.low<32?"protect from frost":"ideal for garden work"}.`]}_getWeatherAlerts(t){return t.alerts&&t.alerts.length>0?t.alerts.map(e=>`${e.event}: ${e.headline}`):["No current weather alerts."]}async chatWithGardener(t,e,n=null){console.log("GeminiService: chatWithGardener called with message:",t),console.log("GeminiService: Garden context:",JSON.stringify(e)),console.log("GeminiService: Weather data provided:",n?"Yes":"No");try{if(!this.isInitialized()&&!this.canRetryAfterFailure())return console.log("In cool-down period after API failure, using fallback chat response"),this._getFallbackChatResponse(t,e);if(!this.isInitialized()&&(console.log("Not initialized, but cool-down period has passed. Attempting to initialize..."),!await this.initialize()))return console.log("Initialization failed, using fallback response"),this._getFallbackChatResponse(t,e);const r=new Date,l=r.getMonth(),a=r.getDate(),c=["January","February","March","April","May","June","July","August","September","October","November","December"][l];let d="";l>=2&&l<=4?d="Spring":l>=5&&l<=7?d="Summer":l>=8&&l<=10?d="Fall":d="Winter";let f="";try{const y=n||await this.getCurrentWeather();f=`
          Current Weather:
          Temperature: ${y.temperature.current}F (High: ${y.temperature.high}F / Low: ${y.temperature.low}F)
          Conditions: ${y.conditions}
          Precipitation: ${y.precipitation.chance}% chance
        `,console.log("GeminiService: Using weather data for chat context:",n?"from provided parameter":"from API call")}catch(y){console.warn("Unable to fetch weather for chat context:",y),f=`Current Season: ${d} in Winston, Oregon`}let m="No plants added yet.";e!=null&&e.plantings&&e.plantings.length>0&&(m=e.plantings.map(y=>`- ${y.plantName} (planted: ${new Date(y.plantedDate).toLocaleDateString()}, location: ${y.areaName}, status: ${y.status})`).join(`
`));let p="No garden areas set up yet.";e!=null&&e.areas&&e.areas.length>0&&(p=e.areas.map(y=>`- ${y.name}: ${y.type}, ${y.sunExposure||"mixed"} sun exposure, ${y.soilType||"regular"} soil`).join(`
`));const g={Spring:"Spring in Winston (March-May): Last frost typically mid-April. Good time for cool-season crops and starting warm-season seeds indoors.",Summer:"Summer in Winston (June-August): Hot and dry. Focus on irrigation, mulching, and heat-tolerant varieties.",Fall:"Fall in Winston (September-November): First frost typically early November. Good for cool-season crops and preparing for winter.",Winter:"Winter in Winston (December-February): Mild winters allow some year-round growing. Cover crops and planning are key activities."},h=`
        You are GardenAI, a helpful gardening assistant specialized for Winston, Oregon (USDA growing zone 8b/9a).
        Today is ${c} ${a}, ${r.getFullYear()}, and we are in ${d}.

        ${g[d]}

        ${f}

        USER'S GARDEN INFORMATION:
        Climate Zone: ${(e==null?void 0:e.climateZone)||"8b/9a (Winston, Oregon)"}

        Garden Areas:
        ${p}

        Plants Currently Growing:
        ${m}

        When giving advice:
        1. Prioritize information specific to the current season (${d}) and month (${c})
        2. Tailor recommendations to the user's specific plants, garden areas, and growing conditions
        3. Reference their garden setup when relevant (e.g., "In your greenhouse areas..." or "For your tomatoes...")
        4. Provide science-based advice that's practical and actionable
        5. Focus on organic and sustainable practices when possible
        6. Consider Winston's climate patterns: mild winters, dry summers, and 200+ day growing season

        If the user asks about adding new plants, suggest varieties that would do well in their specific garden areas.
        If they ask about problems, provide diagnosis and organic solutions when possible.
        Keep responses concise (under 250 words) unless the user asks for detailed information.

        USER QUESTION: ${t}
      `,C={temperature:.4,maxOutputTokens:1024,topP:.95,topK:40};console.log("GeminiService: Sending request to Gemini API with prompt:",h.substring(0,100)+"..."),console.log("GeminiService: Using model:",this.modelId),console.log("GeminiService: Generation config:",JSON.stringify(C));try{const y=await this._callApiWithRateLimit({contents:h,config:C});console.log("GeminiService: API call completed successfully");let T="";if(y.text)T=y.text;else if(y.candidates&&y.candidates[0]){const I=y.candidates[0];I.content&&I.content.parts&&I.content.parts[0]&&(T=I.content.parts[0].text)}console.log("GeminiService: Response text:",T),this.lastSuccessTime=Date.now(),this.consecutiveSuccesses++,this.failureCount=0,this.usageStats.totalRequests++,this.usageStats.requestsByModel[this.modelId]||(this.usageStats.requestsByModel[this.modelId]=0),this.usageStats.requestsByModel[this.modelId]++,y.usageMetadata&&y.usageMetadata.totalTokenCount&&(this.usageStats.totalTokensUsed+=y.usageMetadata.totalTokenCount,console.log(`Used ${y.usageMetadata.totalTokenCount} tokens with model ${this.modelId}`));const v={text:T,safetyRatings:this.getSafetyRatings(y),success:!0,rawResponse:y};return console.log("GeminiService: Returning result:",v),v}catch(y){return console.error("GeminiService: API call failed:",y),this.lastFailureTime=Date.now(),this.failureCount++,y.message&&(y.message.includes("429")||y.message.includes("quota")||y.message.includes("rate limit"))?(console.log("GeminiService: Detected rate limit error, using fallback"),this._getFallbackChatResponse(t,e,"I'm currently operating under API limits. Here's some advice based on your garden information:")):this._getFallbackChatResponse(t,e)}}catch(r){return console.error("GeminiService: Error in chat conversation:",r),this._getFallbackChatResponse(t,e)}}_getFallbackChatResponse(t,e,n=""){console.log("GeminiService: Generating fallback response for:",t);const r=new Date().getMonth(),l=["Winter","Winter","Spring","Spring","Spring","Summer","Summer","Summer","Fall","Fall","Fall","Winter"][r],a=t.toLowerCase().split(/\W+/).filter(p=>p.length>3&&!["what","when","where","which","should","could","would","about"].includes(p));console.log("GeminiService: Extracted keywords:",a);const u={water:["Water deeply and less frequently to encourage strong root growth. For most plants, water when the top 1-2 inches of soil feels dry.","In our climate, most established plants need about 1 inch of water per week during the growing season.","Consider using drip irrigation or soaker hoses to reduce water waste and keep foliage dry, which helps prevent disease."],plant:this._getSeasonalPlantingAdvice(l),grow:this._getSeasonalPlantingAdvice(l),pest:["For organic pest control, try introducing beneficial insects like ladybugs or lacewings.","A mixture of 1 tablespoon mild soap to 1 quart water can help control soft-bodied pests like aphids.","Regular monitoring is key to catching pest problems early. Check the undersides of leaves where many pests hide."],soil:["Our local soil tends to be slightly acidic. Most vegetables prefer a pH of 6.0-7.0.","Adding compost regularly improves soil structure, drainage, and nutrient content.","Consider a soil test to determine specific amendments needed for your garden areas."],fertil:["Use a balanced organic fertilizer for general feeding, or choose specialized formulations based on plant needs.","Too much nitrogen promotes lush foliage but can reduce flowering and fruiting.","Compost tea makes an excellent natural fertilizer that also boosts beneficial soil microorganisms."],season:this._getSeasonalMaintenanceAdvice(l)},c=(e==null?void 0:e.plantings)&&e.plantings.length>0;let d="";if(c){const p=e.plantings.sort((g,h)=>new Date(h.plantedDate)-new Date(g.plantedDate))[0];p.plantName.toLowerCase().includes("tomato")?d="For your tomatoes, consistent watering helps prevent blossom end rot. Consider pruning lower branches for better air circulation.":p.plantName.toLowerCase().includes("pepper")?d="Your peppers will appreciate warm soil and moderate, consistent moisture. Avoid over-fertilizing with nitrogen.":(p.plantName.toLowerCase().includes("lettuce")||p.plantName.toLowerCase().includes("spinach")||p.plantName.toLowerCase().includes("kale"))&&(d="Your leafy greens benefit from consistent moisture and some afternoon shade during hot weather.")}let f="",m=!1;for(const p of a){for(const[g,h]of Object.entries(u))if(p.includes(g)||g.includes(p)){f=h[Math.floor(Math.random()*h.length)],m=!0;break}if(m)break}if(!m){const p=u.season;f=p[Math.floor(Math.random()*p.length)]}return d&&(f+=" "+d),n&&(f=n+" "+f),f+=`

(Note: This is general advice based on your garden information and the current season in Winston, Oregon.)`,{text:f,safetyRatings:null,fallback:!0}}_getSeasonalPlantingAdvice(t){const e={Spring:["Spring is ideal for planting cool-season crops like peas, spinach, lettuce, and radishes.","Wait until after our last frost (typically mid-April) to plant warm-season crops like tomatoes and peppers.","Consider succession planting lettuce and other greens every 2-3 weeks for continuous harvest."],Summer:["Summer is a good time to plant fall crops like broccoli, kale, and cabbage.","In our hot summers, provide afternoon shade for newly planted seedlings.","For late summer planting, focus on quick-maturing crops that can be harvested before frost."],Fall:["Fall is perfect for planting garlic, onions, and cover crops.","Our mild falls allow for cool-season crops like spinach and lettuce to be planted for fall/winter harvest.","Plant trees and shrubs now to give roots time to establish before next summer's heat."],Winter:["Winter is ideal for planning next year's garden and ordering seeds.","Consider using cold frames or row covers to grow cold-hardy greens through winter.","Plant bare-root fruit trees and shrubs during dormant season."]};return e[t]||e.Spring}_getSeasonalMaintenanceAdvice(t){const e={Spring:["Spring is the time to prepare beds with compost and complete any final pruning of dormant plants.","Set up trellises and supports before plants need them.","Monitor for slugs and snails which are particularly active in spring."],Summer:["During summer heat, water deeply in the early morning to reduce evaporation.","Apply organic mulch to conserve moisture and keep roots cool.","Regularly harvest vegetables to encourage continued production."],Fall:["Fall is a good time to collect leaves for compost and mulch.","Clean up diseased plant material, but leave some stems and seed heads for wildlife.","Plant cover crops in empty beds to improve soil over winter."],Winter:["Winter is ideal for pruning dormant fruit trees and shrubs.","Protect sensitive perennials with mulch or row covers during cold snaps.","Service tools and equipment for the upcoming season."]};return e[t]||e.Spring}async testGeminiAPI(){if(!this._initialized)return{success:!1,error:"Gemini service not initialized"};try{console.log("GeminiService: Running API test with model:",this.modelId);const t={maxOutputTokens:1024,temperature:.2,topK:40,topP:.95},n=await this._callApiWithRateLimit({contents:"What are the best vegetables to plant in a home garden during spring? Please provide a short list with brief care instructions.",config:t});console.log("GeminiService: Test completed successfully");let r="";if(n.text)r=n.text;else if(n.candidates&&n.candidates[0]){const l=n.candidates[0];l.content&&l.content.parts&&l.content.parts[0]&&(r=l.content.parts[0].text)}return{success:!0,text:r,safetyRatings:this.getSafetyRatings(n),rawResponse:n}}catch(t){return console.error("GeminiService: Test failed:",t),{success:!1,error:t.message||"An unknown error occurred during the API test"}}}}export{Bs as default};
